<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToM Branch Display - Before & After</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
            background: #f9fafb;
        }
        h1 {
            color: #111827;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #6b7280;
            margin-bottom: 30px;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .panel h2 {
            margin-top: 0;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }
        .before h2 {
            border-bottom-color: #fca5a5;
        }
        .after h2 {
            border-bottom-color: #86efac;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background: #f3f4f6;
            font-weight: 600;
            font-size: 0.875rem;
            color: #374151;
        }
        td:first-child {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
        }
        .answer-pill {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.875rem;
            border: 1px solid;
        }
        .correct {
            background: #dcfce7;
            color: #166534;
            border-color: #86efac;
        }
        .incorrect {
            background: #fee2e2;
            color: #991b1b;
            border-color: #fca5a5;
        }
        .answered {
            background: #f0f9ff;
            color: #0369a1;
            border-color: #bae6fd;
        }
        .highlight {
            background: #fef9c3;
            padding: 2px 4px;
            border-radius: 4px;
        }
        .note {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        .note h3 {
            margin-top: 0;
            color: #1e40af;
        }
        .changes {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .changes h2 {
            color: #374151;
            margin-top: 0;
        }
        .changes ul {
            color: #4b5563;
            line-height: 1.8;
        }
        .changes li {
            margin-bottom: 8px;
        }
        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <h1>Theory of Mind (ToM) - Branch Display Improvements</h1>
    <p class="subtitle">Showing branch information on all questions and proper _TEXT field ordering</p>

    <div class="comparison">
        <div class="panel before">
            <h2>‚ùå Before Fix</h2>
            <table>
                <thead>
                    <tr>
                        <th>Question</th>
                        <th>Student Answer</th>
                        <th>Correct Answer</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ToM_Q1a</td>
                        <td>Êõ≤Â•áÈ§Ö</td>
                        <td>‚Äî</td>
                        <td><span class="answer-pill answered">Answered</span></td>
                    </tr>
                    <tr>
                        <td>ToM_Q1b</td>
                        <td>Á¥ÖËòøËîî</td>
                        <td>Êõ≤Â•áÈ§Ö</td>
                        <td><span class="answer-pill incorrect">Incorrect</span></td>
                    </tr>
                    <tr style="background: #fef3c7;">
                        <td>ToM_Q3a_TEXT</td>
                        <td>Ë≤ì‰ªî</td>
                        <td>‚Äî</td>
                        <td><span class="answer-pill answered">Answered</span></td>
                    </tr>
                    <tr>
                        <td>ToM_Q3a</td>
                        <td>ÂÖ∂‰ªñ</td>
                        <td>Áãó‰ªî</td>
                        <td><span class="answer-pill incorrect">Incorrect</span></td>
                    </tr>
                </tbody>
            </table>
            <div class="note">
                <h3>‚ùå Issues</h3>
                <ul>
                    <li>No branch information shown (can't tell which branch)</li>
                    <li>_TEXT field appears <strong>before</strong> its base question</li>
                    <li>Unclear relationship between questions</li>
                </ul>
            </div>
        </div>

        <div class="panel after">
            <h2>‚úÖ After Fix</h2>
            <table>
                <thead>
                    <tr>
                        <th>Question</th>
                        <th>Student Answer</th>
                        <th>Correct Answer</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ToM_Q1a</td>
                        <td>Êõ≤Â•áÈ§Ö</td>
                        <td>‚Äî</td>
                        <td><span class="answer-pill answered">Answered <span class="highlight">(Êõ≤Â•áÈ§Ö Branch)</span></span></td>
                    </tr>
                    <tr>
                        <td>ToM_Q1b</td>
                        <td>Á¥ÖËòøËîî</td>
                        <td>Êõ≤Â•áÈ§Ö</td>
                        <td><span class="answer-pill incorrect">Incorrect <span class="highlight">(Êõ≤Â•áÈ§Ö Branch)</span></span></td>
                    </tr>
                    <tr>
                        <td>ToM_Q3a</td>
                        <td>ÂÖ∂‰ªñ</td>
                        <td>Áãó‰ªî</td>
                        <td><span class="answer-pill incorrect">Incorrect <span class="highlight">(ÂÖ∂‰ªñ Branch)</span></span></td>
                    </tr>
                    <tr style="background: #d1fae5;">
                        <td>ToM_Q3a_TEXT</td>
                        <td>Ë≤ì‰ªî</td>
                        <td>‚Äî</td>
                        <td><span class="answer-pill answered">Answered <span class="highlight">(ÂÖ∂‰ªñ Branch)</span></span></td>
                    </tr>
                </tbody>
            </table>
            <div class="note">
                <h3>‚úÖ Improvements</h3>
                <ul>
                    <li>Branch information shown on ALL questions</li>
                    <li>_TEXT field appears <strong>after</strong> its base question</li>
                    <li>Clear visual grouping of related questions</li>
                    <li>Easy to verify correct branching logic</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="changes">
        <h2>Key Changes Implemented</h2>
        <ul>
            <li><span class="emoji">üîç</span> <strong>Branch Detection:</strong> Automatically detects ToM branching questions (e.g., ToM_Q1a ‚Üí ToM_Q1b)</li>
            <li><span class="emoji">üè∑Ô∏è</span> <strong>Branch Annotation:</strong> Adds branch information to ALL questions in the set (not just _TEXT fields)</li>
            <li><span class="emoji">üìã</span> <strong>Question Reordering:</strong> _TEXT fields now appear immediately after their corresponding radio questions</li>
            <li><span class="emoji">‚úÖ</span> <strong>Calculation Verified:</strong> _TEXT fields remain excluded from completion percentage (display only)</li>
        </ul>
    </div>

    <div class="changes">
        <h2>Example Scenarios</h2>
        <h3>Scenario 1: Student answers "Êõ≤Â•áÈ§Ö" to ToM_Q1a</h3>
        <ul>
            <li>ToM_Q1a: Shows "Answered <strong>(Êõ≤Â•áÈ§Ö Branch)</strong>"</li>
            <li>ToM_Q1b: Shows result with "<strong>(Êõ≤Â•áÈ§Ö Branch)</strong>" suffix</li>
            <li>System uses the correct answer for "Êõ≤Â•áÈ§Ö" branch when validating ToM_Q1b</li>
        </ul>

        <h3>Scenario 2: Student answers "Á¥ÖËòøËîî" to ToM_Q1a</h3>
        <ul>
            <li>ToM_Q1a: Shows "Answered <strong>(Á¥ÖËòøËîî Branch)</strong>"</li>
            <li>ToM_Q1b: Shows result with "<strong>(Á¥ÖËòøËîî Branch)</strong>" suffix</li>
            <li>System uses the correct answer for "Á¥ÖËòøËîî" branch when validating ToM_Q1b</li>
        </ul>

        <h3>Scenario 3: _TEXT field ordering</h3>
        <ul>
            <li><strong>Before:</strong> ToM_Q3a_TEXT ‚Üí ToM_Q3a (confusing, text before question)</li>
            <li><strong>After:</strong> ToM_Q3a ‚Üí ToM_Q3a_TEXT (logical, question then text response)</li>
        </ul>
    </div>
</body>
</html>
