<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Guide: Assessment Uploader - 4Set System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="assets/js/tailwind.config.js"></script>
  <link rel="stylesheet" href="assets/css/theme_pantone_light_1.css">
  <link rel="stylesheet" href="assets/css/global.css">
  <link rel="stylesheet" href="assets/css/user-guides.css">
  <link rel="stylesheet" href="assets/css/spotlight-system.css">
  <link rel="stylesheet" href="assets/css/tooltip-styles.css">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
    .mermaid {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      mermaid.initialize({ 
        startOnLoad: true,
        theme: 'base',
        themeVariables: {
          primaryColor: '#4A90E2',
          primaryTextColor: '#1F2937',
          primaryBorderColor: '#2E5C8A',
          lineColor: '#6B7280',
          secondaryColor: '#E8F5E9',
          tertiaryColor: '#FFF3E0',
          edgeLabelBackground: '#ffffff',
          textColor: '#1F2937',
          mainBkg: '#ffffff',
          nodeBorder: '#6B7280'
        }
      });
    });
  </script>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <a href="index.html" class="text-2xl font-bold" style="color: var(--primary)">4Set System</a>
          <span class="text-gray-400">|</span>
          <h1 class="text-xl font-semibold text-gray-700">User Guide: Assessment Uploader</h1>
        </div>
        <div class="flex items-center gap-3">
          <a href="quick_start_guide.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Quick Start Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 20V10"></path>
              <path d="M18 20V4"></path>
              <path d="M6 20v-4"></path>
            </svg>
          </a>
          <a href="user_guide_checking_system.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Checking System Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 11 12 14 22 4"></polyline>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
          </a>
          <a href="guide_homepage.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Back to Guide Homepage">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
          </a>
          <a href="index.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Back to System Home">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container mx-auto px-6 py-8">
    <div class="flex gap-8">
      <!-- Sidebar Navigation -->
      <aside class="sidebar w-64 flex-shrink-0">
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-lg font-bold mb-4" style="color: var(--primary)">Table of Contents</h2>
          <nav class="space-y-2">
            <a href="#overview" class="toc-link block text-sm text-gray-700 py-1">Overview</a>
            <a href="#getting-started" class="toc-link block text-sm text-gray-700 py-1">Getting Started</a>
            <a href="#requirements" class="toc-link block text-sm text-gray-700 py-1">System Requirements</a>
            <a href="#upload-process" class="toc-link block text-sm text-gray-700 py-1">Upload Process</a>
            <a href="#pipeline" class="toc-link block text-sm text-gray-700 py-1">Upload Pipeline</a>
            <a href="#processor-agent" class="toc-link block text-sm text-gray-700 py-1">Processor Agent</a>
            <a href="#configuration" class="toc-link block text-sm text-gray-700 py-1">Configuration</a>
            <a href="#troubleshooting" class="toc-link block text-sm text-gray-700 py-1">Troubleshooting</a>
            <a href="#faqs" class="toc-link block text-sm text-gray-700 py-1">FAQs</a>
            <a href="#best-practices" class="toc-link block text-sm text-gray-700 py-1">Best Practices</a>
          </nav>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="flex-1 max-w-4xl">
        <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
          <!-- Document Info -->
          <div class="mb-8 pb-6 border-b border-gray-200">
            <div class="flex flex-wrap gap-4 text-sm text-gray-600">
              <div><strong>Version:</strong> 2.0</div>
              <div><strong>Last Updated:</strong> October 16, 2025</div>
              <div><strong>Target Users:</strong> Research assistants, test administrators, operators</div>
            </div>
          </div>

          <!-- Overview Section -->
          <section id="overview" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Overview</h2>
            
            <!-- Source Note -->
            <div class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
              <p class="text-sm text-gray-700">
                📄 <strong>Markdown Source:</strong> This guide is also available in markdown format at 
                <a href="PRDs/assessment_uploader_user_guide_prd.md" class="text-blue-600 hover:underline font-mono">PRDs/assessment_uploader_user_guide_prd.md</a>
              </p>
            </div>
            
            <p class="text-gray-700 mb-6 text-lg leading-relaxed">
              The <strong>4Set Assessment Uploader</strong> is a web-based interface that allows you to upload assessment PDFs directly from your browser. The system uses modern browser technology to write files to monitored folders.
            </p>

            <h3 class="text-2xl font-semibold mb-4">What It Does</h3>
            <ul class="space-y-2 text-gray-700 mb-6">
              <li>✅ <strong>Direct File Upload:</strong> Write PDF files directly to OneDrive-synced folders</li>
              <li>✅ <strong>Automatic Processing:</strong> Files automatically validated, parsed, and uploaded</li>
              <li>✅ <strong>No Backend Required:</strong> Everything happens in your browser</li>
              <li>✅ <strong>Real-time Status:</strong> See upload progress and completion status instantly</li>
              <li>✅ <strong>Metadata Tracking:</strong> Tracks which PC uploaded each file</li>
            </ul>

            <div class="diagram-box bg-green-50 border-green-300">
              <h4 class="font-semibold mb-3">Key Benefits</h4>
              <ul class="space-y-1 text-gray-700">
                <li>• <strong>Simple:</strong> Drag and drop PDFs or click to browse</li>
                <li>• <strong>Secure:</strong> Files never leave your local network until synced via OneDrive</li>
                <li>• <strong>Fast:</strong> No server uploads - files written directly to local folders</li>
                <li>• <strong>Reliable:</strong> Built-in validation and error handling</li>
              </ul>
            </div>
          </section>

          <!-- Getting Started Section -->
          <section id="getting-started" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Getting Started</h2>

            <h3 class="text-2xl font-semibold mb-4">Quick Start (3 Steps)</h3>

            <div class="diagram-box bg-blue-50 border-blue-300">
              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <div class="step-number">1</div>
                  <div class="text-gray-800">Open <code>upload.html</code> in Chrome/Edge browser</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="step-number">2</div>
                  <div class="text-gray-800">Configure your PC number and upload destination</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="step-number">3</div>
                  <div class="text-gray-800">Drag & drop PDF files to upload</div>
                </div>
              </div>
              <p class="mt-4 text-center text-gray-600 font-semibold">That's it! The processor agent will handle the rest.</p>
            </div>
          </section>

          <!-- System Requirements Section -->
          <section id="requirements" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">System Requirements</h2>

            <div class="grid md:grid-cols-2 gap-6">
              <div class="diagram-box bg-green-50 border-green-300">
                <h3 class="text-xl font-semibold mb-3">✅ Required</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>• <strong>Browser:</strong> Chrome 86+ or Edge 86+</li>
                  <li>• <strong>OS:</strong> Windows 10/11 with OneDrive sync</li>
                  <li>• <strong>Network:</strong> OneDrive folder syncing properly</li>
                  <li>• <strong>Agent:</strong> Processor agent running</li>
                </ul>
              </div>

              <div class="diagram-box bg-red-50 border-red-300">
                <h3 class="text-xl font-semibold mb-3">❌ Not Supported</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>• Firefox (no File System Access API)</li>
                  <li>• Safari (no File System Access API)</li>
                  <li>• Mobile browsers (limited API support)</li>
                  <li>• Private/Incognito mode</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section mt-6">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">How to Check Compatibility</h3>
                <span class="text-2xl">▼</span>
              </div>
              <div class="collapsible-content">
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li>Open Chrome or Edge</li>
                  <li>Visit: <code>chrome://version</code> or <code>edge://version</code></li>
                  <li>Check version number is 86 or higher</li>
                  <li>Verify OneDrive icon shows "Up to date" in system tray</li>
                </ol>
              </div>
            </div>
          </section>

          <!-- Upload Process Section -->
          <section id="upload-process" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Step-by-Step Upload Process</h2>

            <h3 class="text-2xl font-semibold mb-4">First Time Setup</h3>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h4 class="text-lg font-semibold">Step 1: Configure PC Number</h4>
                <span class="text-xl">▼</span>
              </div>
              <div class="collapsible-content">
                <div class="bg-yellow-50 border rounded p-4 mb-4">
                  <div class="text-center space-y-2">
                    <div class="font-semibold">System Status: Setup Required</div>
                    <div><span class="status-badge status-warning">⚠️ PC Number: Not Set</span></div>
                    <div><span class="status-badge status-error">🔴 Destination: Not Set</span></div>
                  </div>
                </div>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li><strong>Click on the red "PC Number" badge</strong> at the top of the page</li>
                  <li>A modal will appear asking for your PC number</li>
                  <li><strong>Enter your 3-digit PC number</strong> (e.g., <code>010</code>, <code>095</code>, <code>999</code>)
                    <ul class="list-disc ml-6 mt-1 space-y-1 text-sm">
                      <li>If your computer is named <code>KS095</code>, enter <code>095</code></li>
                      <li>If you're on <code>LAPTOP-123</code>, enter the assigned number</li>
                    </ul>
                  </li>
                  <li>Click <strong>"Save PC Number"</strong></li>
                  <li>The badge should turn green ✅</li>
                </ol>
                <div class="alert-box alert-info mt-4">
                  <strong>Why is this needed?</strong> The PC number identifies which computer uploaded each file, helping track the source of submissions.
                </div>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h4 class="text-lg font-semibold">Step 2: Set Upload Destination</h4>
                <span class="text-xl">▼</span>
              </div>
              <div class="collapsible-content">
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li><strong>Click on the red "Upload Destination" badge</strong></li>
                  <li>Read the information modal about folder permissions</li>
                  <li>Click <strong>"Set Upload Destination"</strong></li>
                  <li>A browser folder picker will appear</li>
                  <li><strong>Navigate to the monitored folder</strong> (typically <code>incoming/</code>)</li>
                  <li><strong>Click "Select Folder"</strong> to grant permission</li>
                  <li>The badge should turn green ✅</li>
                </ol>
                <div class="alert-box alert-warning mt-4">
                  <strong>Important:</strong> This is a one-time setup per browser. The permission is saved and you won't be asked again.
                </div>
              </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Regular Upload Process</h3>

            <div class="diagram-box">
              <h4 class="font-semibold mb-3">Once Configured</h4>
              <div class="space-y-4">
                <div class="border-l-4 border-blue-500 pl-4">
                  <div class="font-semibold">Method A: Drag & Drop</div>
                  <ol class="text-sm text-gray-700 mt-1 space-y-1">
                    <li>1. Drag one or more PDF files from File Explorer</li>
                    <li>2. Drop them on the upload zone (large dotted box)</li>
                    <li>3. Files will be added to the upload queue</li>
                  </ol>
                </div>
                <div class="border-l-4 border-green-500 pl-4">
                  <div class="font-semibold">Method B: Click to Browse</div>
                  <ol class="text-sm text-gray-700 mt-1 space-y-1">
                    <li>1. Click anywhere in the upload zone</li>
                    <li>2. A file picker will open</li>
                    <li>3. Select one or more PDF files</li>
                    <li>4. Click "Open"</li>
                  </ol>
                </div>
              </div>
            </div>

            <h4 class="text-lg font-semibold mb-3 mt-6">Monitor Progress</h4>
            <div class="bg-gray-50 border rounded p-4">
              <p class="mb-3">A floating panel will show:</p>
              <div class="space-y-2">
                <div class="flex items-center gap-2">
                  <span class="text-yellow-600">⏳</span>
                  <span class="text-sm"><strong>Uploading:</strong> File being written</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="text-green-600">✅</span>
                  <span class="text-sm"><strong>Complete:</strong> File uploaded successfully</span>
                </div>
                <div class="flex items-center gap-2">
                  <span class="text-red-600">❌</span>
                  <span class="text-sm"><strong>Error:</strong> Upload failed (see error message)</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Pipeline Section -->
          <section id="pipeline" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Understanding the Upload Pipeline</h2>

            <div class="diagram-box bg-purple-50 border-purple-300">
              <h3 class="text-lg font-semibold mb-4 text-center">Complete Data Flow</h3>
              <div class="space-y-3 text-sm">
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">1</div>
                  <div><strong>User:</strong> Drag & drop PDF to browser</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">2</div>
                  <div><strong>Browser:</strong> Validate PC number & destination</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">3</div>
                  <div><strong>Local Folder:</strong> Write PDF file & metadata.json</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">4</div>
                  <div><strong>OneDrive:</strong> Auto-sync to cloud (seconds)</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">5</div>
                  <div><strong>Agent:</strong> Detect file and process</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">6</div>
                  <div><strong>Jotform:</strong> Upload submission</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">7</div>
                  <div><strong>Filed:</strong> Move to school folder</div>
                </div>
              </div>
              <div class="mt-4 pt-4 border-t border-purple-200 text-center">
                <strong>Total Time:</strong> <span class="text-purple-700">~30-60 seconds</span> end-to-end
              </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Timeline Summary</h3>
            <table class="text-sm">
              <thead>
                <tr>
                  <th>Step</th>
                  <th>Time</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Upload to browser</td>
                  <td>Instant</td>
                  <td>You see feedback</td>
                </tr>
                <tr>
                  <td>Write files</td>
                  <td>1-2 sec</td>
                  <td>Floating panel updates</td>
                </tr>
                <tr>
                  <td>OneDrive sync</td>
                  <td>5-30 sec</td>
                  <td>Background</td>
                </tr>
                <tr>
                  <td>Agent detection</td>
                  <td>Immediate</td>
                  <td>Background</td>
                </tr>
                <tr>
                  <td>Processing</td>
                  <td>5-10 sec</td>
                  <td>Check logs</td>
                </tr>
                <tr>
                  <td>Jotform upload</td>
                  <td>10-30 sec</td>
                  <td>Check logs</td>
                </tr>
                <tr>
                  <td>Filing</td>
                  <td>Instant</td>
                  <td>Check filed/ folder</td>
                </tr>
              </tbody>
            </table>
          </section>

          <!-- Processor Agent Workflow Section -->
          <section id="processor-agent" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Processor Agent: How It Works</h2>
            
            <p class="text-gray-700 mb-6">
              The <strong>Processor Agent</strong> is an autonomous PowerShell service that continuously monitors the upload folder, validates PDFs, enriches data, and submits to Jotform. Here's how it processes your uploaded files:
            </p>

            <!-- Complete Processing Flowchart -->
            <div class="bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg border-2 border-indigo-200 mb-8">
              <h3 class="font-semibold mb-6 text-center text-lg">Complete Processing Workflow</h3>
              
              <div class="mermaid">
flowchart TD
    Start([📂 File Detected]) --> NameCheck{Filename<br/>approximately<br/>correct?}
    
    NameCheck -->|NO - Invalid format| Reject1[❌ REJECTED<br/>→ Quarantine folder]
    NameCheck -->|YES - Lenient match| Phase1{Is filename<br/>valid?<br/>Phase 1}
    
    Phase1 -->|NO| Reject2[❌ REJECTED<br/>→ Quarantine folder]
    Phase1 -->|YES| Phase2{PDF fields<br/>valid?<br/>Phase 2}
    
    Phase2 -->|NO| Reject3[❌ REJECTED<br/>→ Quarantine folder]
    Phase2 -->|YES| Process[🔄 Processing<br/>1. Parse PDF<br/>2. Calculate termination<br/>3. Enrich metadata<br/>4. Prepare JSON]
    
    Process --> Conflict{Data<br/>conflict?}
    
    Conflict -->|CONFLICT| Blocked[⚠️ BLOCKED<br/>→ Quarantine folder]
    Conflict -->|SAFE| Upload[📤 Upload to Jotform<br/>Max 3 retries + backoff]
    
    Upload --> UploadResult{Upload<br/>success?}
    
    UploadResult -->|FAILED| Error[❌ ERROR<br/>→ Quarantine folder]
    UploadResult -->|SUCCESS| File["📁 File to School Folder<br/>→ School-specific folder"]
    
    File --> Complete([✅ COMPLETE])
    
    style Start fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Complete fill:#4CAF50,stroke:#2E7D32,color:#fff
    style Process fill:#E1BEE7,stroke:#9C27B0,color:#4A148C
    style Upload fill:#BBDEFB,stroke:#2196F3,color:#0D47A1
    style File fill:#C8E6C9,stroke:#4CAF50,color:#1B5E20
    style Reject1 fill:#FFE0E0,stroke:#E57373,color:#C62828
    style Reject2 fill:#FFE0E0,stroke:#E57373,color:#C62828
    style Reject3 fill:#FFE0E0,stroke:#E57373,color:#C62828
    style Blocked fill:#FFE0B2,stroke:#FF9800,color:#E65100
    style Error fill:#FFE0E0,stroke:#E57373,color:#C62828
    style NameCheck fill:#E1F5FE,stroke:#03A9F4,color:#01579B
    style Phase1 fill:#FFF9E0,stroke:#FFD54F,color:#F57C00
    style Phase2 fill:#FFE0B2,stroke:#FF9800,color:#E65100
    style Conflict fill:#F8BBD0,stroke:#F06292,color:#880E4F
    style UploadResult fill:#B2DFDB,stroke:#26A69A,color:#004D40
              </div>
              
              <div class="mt-6 pt-4 border-t border-indigo-200 text-center text-sm text-gray-700">
                <strong>Total Processing Time:</strong> 5-30 seconds per PDF (typical)<br/>
                <span class="text-xs text-gray-600 mt-1">Note: Filename validation uses lenient matching - slight variations in format are accepted</span>
              </div>
            </div>

            <!-- Validation Phases Detail -->
            <h3 class="text-2xl font-semibold mb-4 mt-8">Validation Phases Explained</h3>
            
            <div class="grid md:grid-cols-2 gap-6 mb-8">
              <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded shadow">
                <h4 class="font-semibold mb-3 text-yellow-800">Phase 1: Filename Validation</h4>
                <p class="text-sm text-gray-700 mb-2"><strong>Expected Format:</strong></p>
                <code class="text-xs bg-white px-2 py-1 rounded">coreID_YYYYMMDD_HH_MM.pdf</code>
                <p class="text-xs mt-2 text-gray-600 italic">Core ID: 5-digit numeric identifier from AITable</p>
                <p class="text-sm text-gray-700 mt-3"><strong>Checks:</strong></p>
                <ul class="text-xs space-y-1 mt-2">
                  <li>✓ 5-digit Core ID (numeric only, starts with 1)</li>
                  <li>✓ Valid date format (YYYYMMDD)</li>
                  <li>✓ Valid time format (HH_MM)</li>
                  <li>✓ Underscores in correct positions</li>
                </ul>
                <p class="text-xs mt-3 text-gray-600"><strong>Example:</strong> 10001_20251016_14_30.pdf ✅</p>
              </div>
              
              <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded shadow">
                <h4 class="font-semibold mb-3 text-orange-800">Phase 2: PDF Content Validation</h4>
                <p class="text-sm text-gray-700 mb-2"><strong>Checks:</strong></p>
                <ul class="text-xs space-y-1">
                  <li>✓ Student ID in mapping file</li>
                  <li>✓ School ID exists</li>
                  <li>✓ Required fields present</li>
                  <li>✓ Data types correct</li>
                  <li>✓ Value ranges valid</li>
                </ul>
                <p class="text-xs mt-3 text-gray-600"><strong>Sources:</strong> assets/*.enc mapping files</p>
              </div>
            </div>

            <!-- Data Overwrite Protection -->
            <h3 class="text-2xl font-semibold mb-4">Data Overwrite Protection</h3>

            <!-- Why This Matters -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border-2 border-blue-300 mb-6">
              <h4 class="font-semibold mb-3 text-blue-900">🔒 Why Data Overwrite Protection is Critical</h4>
              <div class="text-sm text-gray-700 space-y-2">
                <p><strong>Assessment data integrity is paramount.</strong> Once test administrators record student responses and upload PDFs, that data becomes the official record of the child's performance. Any accidental overwrite could:</p>
                <ul class="list-disc ml-6 space-y-1 mt-2">
                  <li><strong>Loss of irreplaceable data:</strong> Student responses cannot be re-administered - once lost, they're gone forever</li>
                  <li><strong>Research validity compromise:</strong> Changing recorded answers invalidates study results and scientific conclusions</li>
                  <li><strong>Regulatory compliance issues:</strong> Educational research requires audit trails showing data hasn't been tampered with</li>
                  <li><strong>Accidental errors:</strong> Re-uploading the same student by mistake (e.g., wrong filename) could silently overwrite correct data</li>
                </ul>
                <p class="mt-3 font-semibold text-blue-800">The system prevents these scenarios by blocking any attempt to change existing assessment answers while still allowing corrections to administrative metadata (student names, school IDs, etc.).</p>
              </div>
            </div>

            <!-- Conflict Detection Workflow -->
            <div class="bg-gradient-to-br from-pink-50 to-red-50 p-6 rounded-lg border-2 border-pink-300 mb-6">
              <h4 class="font-semibold mb-6 text-center text-lg">Data Overwrite Protection Workflow</h4>
              
              <div class="mermaid">
flowchart TD
    Start([New PDF Upload<br/>Attempt]) --> Parse[Parse PDF<br/>Extract Data]
    
    Parse --> Search{Does student<br/>submission<br/>exist?}
    
    Search -->|NO - New Student| AllowNew[✅ ALLOW<br/>Create New<br/>Submission]
    Search -->|YES - Existing| CheckFields{Check Each<br/>Field}
    
    CheckFields --> FieldType{Field<br/>Type?}
    
    FieldType -->|Admin Info<br/>student-id, name,<br/>school-id, class| MetaCheck{Current<br/>Value?}
    MetaCheck -->|Empty/Null| AllowMeta[✅ ALLOW<br/>Fill Empty<br/>Admin Info]
    MetaCheck -->|Has Value| AllowUpdate[✅ ALLOW<br/>Update Admin Info]
    
    FieldType -->|Test Answers<br/>ERV, CM, CWR,<br/>termination| DataCheck{Current<br/>Value?}
    DataCheck -->|Empty/Null| AllowData[✅ ALLOW<br/>Fill Empty<br/>Test Data]
    DataCheck -->|Has Value| BlockData[❌ BLOCK<br/>Protect Existing<br/>Test Answers]
    
    AllowNew --> LogSuccess[📝 Log to CSV:<br/>Success entry]
    AllowMeta --> LogSuccess
    AllowUpdate --> LogSuccess
    AllowData --> LogSuccess
    
    BlockData --> LogConflict["📝 Log to CSV:<br/>CONFLICT entry<br/>with field details"]
    
    LogConflict --> MoveQuarantine["⚠️ Move PDF to<br/>Quarantine Folder"]
    
    MoveQuarantine --> NotifyAdmin["🔔 Admin Reviews<br/>CSV Log Entry<br/>+ Quarantined PDF"]
    
    LogSuccess --> FileSchool["📁 Move PDF to<br/>School's Folder<br/>+ Create JSON"]
    
    FileSchool --> Complete([✅ Upload Complete])
    NotifyAdmin --> End([❌ Upload Blocked])
    
    style Start fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Complete fill:#4CAF50,stroke:#2E7D32,color:#fff
    style End fill:#E57373,stroke:#C62828,color:#fff
    style AllowNew fill:#C8E6C9,stroke:#4CAF50,color:#1B5E20
    style AllowMeta fill:#C8E6C9,stroke:#4CAF50,color:#1B5E20
    style AllowUpdate fill:#C8E6C9,stroke:#4CAF50,color:#1B5E20
    style AllowData fill:#C8E6C9,stroke:#4CAF50,color:#1B5E20
    style BlockData fill:#FFCDD2,stroke:#E57373,color:#C62828
    style MoveQuarantine fill:#FFE0B2,stroke:#FF9800,color:#E65100
    style LogConflict fill:#FFF9C4,stroke:#FDD835,color:#F57F17
    style LogSuccess fill:#E8F5E9,stroke:#66BB6A,color:#2E7D32
    style Search fill:#E1F5FE,stroke:#03A9F4,color:#01579B
    style CheckFields fill:#F3E5F5,stroke:#AB47BC,color:#4A148C
    style FieldType fill:#FFF3E0,stroke:#FFA726,color:#E65100
    style MetaCheck fill:#E0F2F1,stroke:#26A69A,color:#004D40
    style DataCheck fill:#FCE4EC,stroke:#EC407A,color:#880E4F
              </div>
              
              <div class="mt-6 p-4 bg-white rounded border border-pink-200">
                <p class="text-sm font-semibold mb-2">Key Decision Points:</p>
                <ol class="text-xs text-gray-700 space-y-1 ml-4">
                  <li>1. <strong>New vs Existing:</strong> New students always allowed; existing students trigger protection checks</li>
                  <li>2. <strong>Field Type:</strong> Administrative info (student details, school assignment) vs Test Answers (actual assessment responses)</li>
                  <li>3. <strong>Admin Info:</strong> Can be updated to correct administrative errors (typos in names, wrong school assignment, PC number, etc.)</li>
                  <li>4. <strong>Test Answers:</strong> Once recorded, cannot be changed - protects scientific integrity of the assessment data</li>
                  <li>5. <strong>Empty Fields:</strong> Can always be filled, whether admin info or test data</li>
                  <li>6. <strong>Logging:</strong> All decisions logged to daily CSV file (YYYYMMDD_processing_agent.csv) for audit trail</li>
                </ol>
              </div>
            </div>
            
            <div class="bg-gradient-to-r from-pink-50 to-red-50 p-6 rounded-lg border-2 border-pink-300 mb-6">
              <h4 class="font-semibold mb-4 text-center">Conflict Detection Rules</h4>
              
              <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-white rounded p-4 shadow-sm border-l-4 border-green-500">
                  <h5 class="font-semibold text-green-800 mb-2">✅ ALLOWED Updates</h5>
                  <ul class="text-sm space-y-1">
                    <li>• Filling blank/null fields</li>
                    <li>• Updating metadata fields:
                      <ul class="ml-4 text-xs mt-1 space-y-1">
                        <li>- student-id</li>
                        <li>- child-name</li>
                        <li>- school-id</li>
                        <li>- district</li>
                        <li>- class-id</li>
                        <li>- computerno</li>
                      </ul>
                    </li>
                    <li>• Same value (no change)</li>
                  </ul>
                </div>
                
                <div class="bg-white rounded p-4 shadow-sm border-l-4 border-red-500">
                  <h5 class="font-semibold text-red-800 mb-2">❌ BLOCKED Updates</h5>
                  <ul class="text-sm space-y-1">
                    <li>• Changing assessment data:
                      <ul class="ml-4 text-xs mt-1 space-y-1">
                        <li>- ERV answers</li>
                        <li>- CM answers</li>
                        <li>- CWR answers</li>
                        <li>- Termination values</li>
                        <li>- Background data</li>
                      </ul>
                    </li>
                    <li>• Overwriting non-empty fields</li>
                  </ul>
                </div>
              </div>
              
              <div class="mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded text-center">
                <p class="text-sm text-gray-800">
                  <strong>🛡️ Protection Goal:</strong> Prevent accidental data corruption while allowing metadata corrections
                </p>
              </div>
            </div>

            <!-- Where Blocked Updates Go -->
            <div class="bg-gradient-to-r from-orange-50 to-yellow-50 p-6 rounded-lg border-2 border-orange-300 mb-6">
              <h4 class="font-semibold mb-3 text-orange-900">📂 Where Do Blocked Updates Go?</h4>
              <div class="text-sm text-gray-700 space-y-3">
                <p>When the processor agent detects a data conflict and blocks an upload, the files are moved to a special quarantine location for review:</p>
                
                <div class="bg-white p-4 rounded border-l-4 border-orange-500 mt-3">
                  <p class="font-semibold mb-2">📁 File Destination:</p>
                  <div class="bg-gray-800 text-gray-100 p-3 rounded font-mono text-xs">
                    <div>quarantine_folder/</div>
                    <div>├── 10523_20251016_14_30.pdf</div>
                    <div>└── (Logged in CSV: YYYYMMDD_processing_agent.csv)</div>
                  </div>
                  <p class="text-xs text-gray-600 mt-2 italic">Note: Quarantine folder path is configurable (default: "unsorted")</p>
                </div>

                <p><strong>What Happens:</strong></p>
                <ol class="list-decimal ml-6 space-y-2">
                  <li><strong>PDF moved to quarantine folder:</strong> The file is not deleted, just quarantined for manual review</li>
                  <li><strong>Conflict logged to CSV:</strong> Details written to the daily CSV log file (not individual .log files)</li>
                  <li><strong>JSON data deleted:</strong> The processed JSON is not saved to prevent corruption</li>
                  <li><strong>Jotform not updated:</strong> No API call is made to Jotform, protecting existing data</li>
                  <li><strong>PC number recorded:</strong> The uploader's PC number (from upload.html manual setting) is logged for tracking</li>
                </ol>

                <p class="mt-3"><strong>⚠️ Important:</strong> Files in quarantine folder require manual review by administrators to determine if:</p>
                <ul class="list-disc ml-6 space-y-1">
                  <li>It's a legitimate re-upload attempt that should be manually processed</li>
                  <li>It's an accidental duplicate that should be deleted</li>
                  <li>It's a different student with a similar/wrong filename</li>
                </ul>
              </div>
            </div>

            <!-- How Logs Help -->
            <div class="bg-gradient-to-r from-purple-50 to-indigo-50 p-6 rounded-lg border-2 border-purple-300 mb-6">
              <h4 class="font-semibold mb-3 text-purple-900">📝 How Logs Help Check What Went Wrong</h4>
              <div class="text-sm text-gray-700 space-y-3">
                <p>The processor agent maintains a detailed CSV log that helps administrators diagnose and resolve conflicts:</p>

                <div class="bg-white p-4 rounded border-l-4 border-purple-500 mt-4">
                  <h5 class="font-semibold mb-2">Daily Processing Log (CSV Format)</h5>
                  <p class="text-xs mb-2"><code class="bg-gray-200 px-2 py-1 rounded">logs/YYYYMMDD_processing_agent.csv</code></p>
                  <p class="text-xs mb-2">Single CSV file per day tracking all processing activity</p>
                  
                  <div class="mt-3 p-2 bg-blue-50 border border-blue-200 rounded text-xs">
                    <p class="font-semibold mb-1">📌 Configurable Log Levels:</p>
                    <p class="mb-2">Edit <code class="bg-white px-1 rounded">config/jotform_config.json</code> → "logging" section to enable/disable each level:</p>
                    <ul class="space-y-0.5 ml-4">
                      <li>• <strong>REJECT:</strong> Validation failures (sessionkey mismatch, Core ID errors, filename format)</li>
                      <li>• <strong>DATA_OVERWRITE_DIFF:</strong> Data overwrite conflicts (field-level details)</li>
                      <li>• <strong>UPLOAD:</strong> Jotform operations (created/updated submissions)</li>
                      <li>• <strong>FILED:</strong> Successfully archived files with destination folder</li>
                      <li>• <strong>CLEANUP:</strong> Maintenance operations (orphaned JSON cleanup)</li>
                      <li>• <strong>RENAME:</strong> Filename normalization (original → canonical)</li>
                      <li>• <strong>WARN:</strong> Non-critical issues (missing mappings, upload failures)</li>
                      <li>• <strong>ERROR:</strong> Critical failures (parser errors, exceptions)</li>
                      <li>• <strong>INFO:</strong> Verbose details (queued, parsing, validating, enriching)</li>
                    </ul>
                    <p class="mt-2 text-gray-600 italic">Set each level to <code>true</code> (log) or <code>false</code> (skip) in config</p>
                  </div>
                </div>

                <div class="bg-white p-4 rounded border border-purple-200 mt-4">
                  <p class="font-semibold mb-3">Example CSV Log Entries (as viewed in Excel/CSV reader):</p>
                  
                  <!-- Excel-like table view -->
                  <div class="overflow-x-auto">
                    <table class="w-full text-xs border-collapse">
                      <thead>
                        <tr class="bg-gray-100 border-b-2 border-gray-300">
                          <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Timestamp</th>
                          <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Level</th>
                          <th class="border border-gray-300 px-3 py-2 text-left font-semibold">File</th>
                          <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Message</th>
                        </tr>
                      </thead>
                      <tbody class="font-mono">
                        <tr class="bg-white hover:bg-gray-50">
                          <td class="border border-gray-300 px-3 py-2">2025-10-25 14:30:15</td>
                          <td class="border border-gray-300 px-3 py-2 text-red-600 font-semibold">REJECT</td>
                          <td class="border border-gray-300 px-3 py-2">10523_20251016_14_30.pdf</td>
                          <td class="border border-gray-300 px-3 py-2">Phase2 validation failed: Core ID 10523 not in mapping</td>
                        </tr>
                        <tr class="bg-gray-50 hover:bg-gray-100">
                          <td class="border border-gray-300 px-3 py-2">2025-10-25 14:31:22</td>
                          <td class="border border-gray-300 px-3 py-2 text-orange-600 font-semibold">DATA_OVERWRITE_DIFF</td>
                          <td class="border border-gray-300 px-3 py-2">10524_20251016_14_35.pdf</td>
                          <td class="border border-gray-300 px-3 py-2">Field q37_englishReceptive[0]: Current '1' vs Attempted '0'</td>
                        </tr>
                        <tr class="bg-white hover:bg-gray-50">
                          <td class="border border-gray-300 px-3 py-2">2025-10-25 14:32:10</td>
                          <td class="border border-gray-300 px-3 py-2 text-blue-600 font-semibold">UPLOAD</td>
                          <td class="border border-gray-300 px-3 py-2">10525_20251016_14_40.pdf</td>
                          <td class="border border-gray-300 px-3 py-2">Created submission 234567890123456789 (87 fields, 1 chunk)</td>
                        </tr>
                        <tr class="bg-gray-50 hover:bg-gray-100">
                          <td class="border border-gray-300 px-3 py-2">2025-10-25 14:33:05</td>
                          <td class="border border-gray-300 px-3 py-2 text-green-600 font-semibold">FILED</td>
                          <td class="border border-gray-300 px-3 py-2">10525_20251016_14_40.pdf</td>
                          <td class="border border-gray-300 px-3 py-2">10525_20251016_14_40.pdf → S023/</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  <p class="text-xs text-gray-600 mt-3 italic">💡 Tip: Open CSV files in Excel, Google Sheets, or VS Code with Rainbow CSV extension for easier filtering and analysis</p>
                </div>

                <div class="mt-4 p-3 bg-purple-100 border border-purple-300 rounded">
                  <p class="font-semibold mb-2">Using CSV Logs for Troubleshooting:</p>
                  <ol class="text-xs space-y-1 ml-4">
                    <li>1. <strong>Open today's CSV log:</strong> Find YYYYMMDD_processing_agent.csv in the logs directory</li>
                    <li>2. <strong>Search for filename:</strong> Look for rows with the problematic PDF filename</li>
                    <li>3. <strong>Check log level:</strong> REJECT/ERROR/CONFLICT indicate problems; SUCCESS/FILED indicate completion</li>
                    <li>4. <strong>Read the message:</strong> Detailed reason explains exactly what went wrong</li>
                    <li>5. <strong>Locate quarantined PDF:</strong> Check the quarantine folder for the actual file</li>
                    <li>6. <strong>Determine action:</strong> Based on the CSV message, decide whether to:
                      <ul class="list-disc ml-6 mt-1">
                        <li>Delete the quarantined file (if duplicate/wrong)</li>
                        <li>Manually fix Jotform data (if existing data is wrong)</li>
                        <li>Contact test administrator (if assessment needs re-administration)</li>
                      </ul>
                    </li>
                  </ol>
                </div>
              </div>
            </div>

            <!-- Retry Logic -->
            <h3 class="text-2xl font-semibold mb-4">Upload Retry Strategy</h3>
            
            <div class="bg-blue-50 p-4 rounded border-2 border-blue-300">
              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <div class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">1</div>
                  <div class="text-sm">
                    <strong>First Attempt:</strong> Immediate upload
                  </div>
                </div>
                
                <div class="flex items-center gap-3">
                  <div class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">2</div>
                  <div class="text-sm">
                    <strong>Retry 1:</strong> Wait 2 seconds + random jitter (0-1s)
                  </div>
                </div>
                
                <div class="flex items-center gap-3">
                  <div class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">3</div>
                  <div class="text-sm">
                    <strong>Retry 2:</strong> Wait 4 seconds + random jitter (0-2s)
                  </div>
                </div>
                
                <div class="flex items-center gap-3">
                  <div class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold flex-shrink-0">4</div>
                  <div class="text-sm">
                    <strong>Retry 3:</strong> Wait 8 seconds + random jitter (0-4s)
                  </div>
                </div>
                
                <div class="mt-3 pt-3 border-t border-blue-200 text-center">
                  <div class="text-sm">
                    <strong>If all retries fail:</strong> <span class="text-red-600">File moved to Unsorted/ with error log</span>
                  </div>
                </div>
              </div>
            </div>

          </section>

          <!-- Configuration Section -->
          <section id="configuration" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Configuration and Setup</h2>

            <!-- Config File Overview -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border-2 border-blue-300 mb-6">
              <h3 class="text-2xl font-semibold mb-4 text-blue-900">📋 Configuration Files</h3>
              <p class="text-sm text-gray-700 mb-4">The processor agent uses JSON configuration files to control its behavior. All files are located in the <code class="bg-white px-2 py-1 rounded">config/</code> directory.</p>
              
              <div class="space-y-4">
                <div class="bg-white p-4 rounded border-l-4 border-blue-500">
                  <h4 class="font-semibold text-blue-800 mb-2">config/agent.json</h4>
                  <p class="text-sm text-gray-700 mb-2"><strong>Purpose:</strong> Main agent configuration - folder paths, OneDrive sync, polling behavior</p>
                  <details class="text-sm">
                    <summary class="cursor-pointer font-semibold text-blue-700 hover:text-blue-900">View Key Settings</summary>
                    <ul class="ml-6 mt-2 space-y-1 text-xs">
                      <li><strong>oneDrive.relativePath:</strong> Path to project folder within OneDrive</li>
                      <li><strong>watchPath:</strong> Folder where uploader writes PDFs (default: ./incoming)</li>
                      <li><strong>stagingPath:</strong> Temporary processing folder (default: ./processing)</li>
                      <li><strong>filingRoot:</strong> Base folder for organized PDFs (default: ./filed)</li>
                      <li><strong>unsortedRoot:</strong> Quarantine folder for rejected PDFs (default: ./filed/Unsorted)</li>
                      <li><strong>worker.maxConcurrent:</strong> Max PDFs processed simultaneously (default: 2)</li>
                      <li><strong>worker.pollIntervalSeconds:</strong> How often to check for new files (default: 5s)</li>
                    </ul>
                  </details>
                </div>

                <div class="bg-white p-4 rounded border-l-4 border-green-500">
                  <h4 class="font-semibold text-green-800 mb-2">config/jotform_config.json</h4>
                  <p class="text-sm text-gray-700 mb-2"><strong>Purpose:</strong> Jotform API settings, retry logic, and log level configuration</p>
                  <details class="text-sm">
                    <summary class="cursor-pointer font-semibold text-green-700 hover:text-green-900">View Key Settings</summary>
                    <ul class="ml-6 mt-2 space-y-1 text-xs">
                      <li><strong>powershell.maxConcurrentPdfs:</strong> PDFs processed in parallel (default: 2)</li>
                      <li><strong>powershell.maxRetries:</strong> Upload retry attempts (default: 4)</li>
                      <li><strong>powershell.rateLimitMs:</strong> Delay between API calls (default: 200ms)</li>
                      <li><strong>logging.*:</strong> Enable/disable each log level (true/false)</li>
                    </ul>
                    <div class="mt-2 p-2 bg-green-50 rounded">
                      <p class="font-semibold text-xs">💡 See "How Logs Help" section for all 9 configurable log levels</p>
                    </div>
                  </details>
                </div>

                <div class="bg-white p-4 rounded border-l-4 border-purple-500">
                  <h4 class="font-semibold text-purple-800 mb-2">config/host_identity.json</h4>
                  <p class="text-sm text-gray-700 mb-2"><strong>Purpose:</strong> Override PC identity (optional - usually auto-detected)</p>
                  <details class="text-sm">
                    <summary class="cursor-pointer font-semibold text-purple-700 hover:text-purple-900">View Example</summary>
                    <pre class="mt-2 p-2 bg-gray-800 text-gray-100 rounded text-xs overflow-x-auto">{
  "computerName": "KS095",
  "pcNumber": "095"
}</pre>
                  </details>
                </div>
              </div>
            </div>

            <!-- Config GUI -->
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border-2 border-purple-300 mb-6">
              <h3 class="text-2xl font-semibold mb-4 text-purple-900">🖥️ Configuration GUI Tool</h3>
              <p class="text-sm text-gray-700 mb-4">A graphical interface for editing agent configuration without manually editing JSON files.</p>
              
              <div class="bg-white p-4 rounded border-l-4 border-purple-500 mb-4">
                <h4 class="font-semibold mb-2">How to Launch</h4>
                <ol class="list-decimal ml-6 space-y-1 text-sm text-gray-700">
                  <li>Navigate to <code class="bg-gray-200 px-2 py-1 rounded">tools/</code> directory</li>
                  <li>Run: <code class="bg-gray-800 text-gray-100 px-2 py-1 rounded">python agent_config_gui.py</code></li>
                  <li>GUI window opens with editable configuration fields</li>
                </ol>
              </div>

              <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded shadow">
                  <h5 class="font-semibold text-purple-800 mb-2">✅ What You Can Edit</h5>
                  <ul class="text-sm space-y-1">
                    <li>• OneDrive Relative Path</li>
                    <li>• Watch Path (incoming folder)</li>
                    <li>• Staging Path (processing folder)</li>
                    <li>• Filing Root (organized PDFs)</li>
                    <li>• Unsorted Root (quarantine folder)</li>
                  </ul>
                </div>

                <div class="bg-white p-4 rounded shadow">
                  <h5 class="font-semibold text-purple-800 mb-2">🛠️ Features</h5>
                  <ul class="text-sm space-y-1">
                    <li>• Browse button (...) to select folders</li>
                    <li>• Save button to persist changes</li>
                    <li>• Reset to Defaults button</li>
                    <li>• Reload from File button</li>
                    <li>• Status bar shows operation results</li>
                  </ul>
                </div>
              </div>

              <div class="mt-4 p-3 bg-yellow-100 border border-yellow-300 rounded">
                <p class="text-sm"><strong>⚠️ Important:</strong> After saving changes in the GUI, restart the processor agent for changes to take effect.</p>
              </div>
            </div>

            <!-- PC Number Config -->
            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">PC Number Configuration</h3>
                <span class="text-2xl">▼</span>
              </div>
              <div class="collapsible-content">
                <h4 class="font-semibold mb-2">Auto-Detection</h4>
                
                <!-- Interactive Screenshot: Upload Configuration Status Badges -->
                <div class="border-2 border-gray-300 rounded-lg overflow-hidden my-6 shadow-lg upload-config-preview-container" style="position: relative;">
                  <!-- "See More" button - shown on hover -->
                  <button 
                    class="upload-config-enlarge-btn" 
                    onclick="openUploadConfigModal()"
                    style="position: absolute; top: 12px; right: 12px; z-index: 50; background-color: rgba(43, 57, 144, 0.95); color: white; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.2s ease; cursor: pointer; border: none;"
                    title="See More"
                  >
                    <span style="display: flex; align-items: center; gap: 6px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M9 21H3v-6"/><path d="M21 3l-7 7"/><path d="M3 21l7-7"/></svg>
                      See More
                    </span>
                  </button>
                  
                  <!-- Preview of upload configuration badges -->
                  <div style="padding: 3rem 2rem; background: linear-gradient(135deg, #e0e7ff 0%, #f3f4f6 100%);">
                    <div class="text-center space-y-4">
                      <div class="font-semibold text-lg text-gray-800 mb-3">Upload Configuration Status</div>
                      <div class="flex justify-center gap-4 flex-wrap">
                        <div class="px-4 py-2 rounded-full bg-red-100 text-red-700 font-semibold text-sm border-2 border-red-300 shadow-sm">
                          ⚠️ PC Number: Not Set
                        </div>
                        <div class="px-4 py-2 rounded-full bg-red-100 text-red-700 font-semibold text-sm border-2 border-red-300 shadow-sm">
                          🔴 Destination: Not Set
                        </div>
                      </div>
                      <div class="text-sm text-gray-600 italic mt-4">Click badges to configure (opens modal)</div>
                    </div>
                  </div>
                </div>
                
                <style>
                  .upload-config-preview-container:hover .upload-config-enlarge-btn {
                    opacity: 1 !important;
                  }
                  .upload-config-enlarge-btn:hover {
                    background-color: rgba(43, 57, 144, 1) !important;
                    transform: translateY(-2px);
                    box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
                  }
                </style>
                
                <p class="text-gray-700 mb-3">The system tries to auto-detect your PC number from:</p>
                <ol class="list-decimal ml-6 space-y-1 text-gray-700 mb-4">
                  <li>Computer name (e.g., <code>KS095</code> → <code>095</code>)</li>
                  <li>Username in file paths</li>
                  <li>Registry settings</li>
                </ol>
                <p class="text-gray-700 mb-3">If auto-detection fails, you'll see <code>000</code> or <code>???</code> - configure manually.</p>

                <h4 class="font-semibold mb-2 mt-4">Manual Configuration</h4>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li>Click the PC Number badge (red or showing wrong number)</li>
                  <li>Enter your 3-digit number</li>
                  <li><strong>Formatting:</strong> System auto-pads to 3 digits
                    <ul class="list-disc ml-6 mt-1 space-y-1 text-sm">
                      <li>Enter <code>10</code> → Saved as <code>010</code></li>
                      <li>Enter <code>95</code> → Saved as <code>095</code></li>
                      <li>Enter <code>999</code> → Saved as <code>999</code></li>
                    </ul>
                  </li>
                  <li><strong>Validation:</strong> Must be numeric and not <code>000</code></li>
                </ol>

                <div class="alert-box alert-info mt-4">
                  <strong>Storage:</strong> Saved in browser's localStorage, persists across page refreshes, cleared if you clear browser data.
                </div>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">Upload Destination Configuration</h3>
                <span class="text-2xl">▼</span>
              </div>
              <div class="collapsible-content">
                <p class="text-gray-700 mb-3">The upload destination is the folder where the processor agent watches for new files.</p>
                <p class="text-gray-700 mb-4"><strong>Typical Setup:</strong></p>
                <pre class="text-xs">C:\Users\[YourName]\OneDrive - Organization\
  └── Project Folder\
      └── incoming\          ← Select this folder</pre>

                <h4 class="font-semibold mb-2 mt-4">Permission Model</h4>
                <p class="text-gray-700 mb-2">When you set the destination:</p>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li><strong>Browser shows native folder picker</strong> (Chrome/Edge security feature)</li>
                  <li><strong>You select the folder</strong> (exact folder agent monitors)</li>
                  <li><strong>Permission granted</strong> (persists until you clear browser data)</li>
                  <li><strong>Verification</strong> (badge turns green ✅)</li>
                </ol>
              </div>
            </div>
          </section>

          <!-- Troubleshooting Section -->
          <section id="troubleshooting" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Troubleshooting</h2>

            <div class="space-y-4">
              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-xl font-semibold">"Files not appearing in folder"</h3>
                  <span class="text-2xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="mb-3"><strong>Possible Causes:</strong></p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700 mb-4">
                    <li>Wrong folder selected</li>
                    <li>Permission expired/revoked</li>
                    <li>OneDrive sync paused</li>
                  </ol>
                  <p class="mb-3"><strong>Solutions:</strong></p>
                  <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                    <li>Verify folder path in badge</li>
                    <li>Re-grant folder permission</li>
                    <li>Check OneDrive sync status (system tray icon)</li>
                    <li>Restart OneDrive if needed</li>
                  </ol>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-xl font-semibold">"Can't save PC number"</h3>
                  <span class="text-2xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="mb-3"><strong>Possible Causes:</strong></p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700 mb-4">
                    <li>LocalStorage disabled</li>
                    <li>Private browsing mode</li>
                    <li>Browser storage full</li>
                  </ol>
                  <p class="mb-3"><strong>Solutions:</strong></p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700">
                    <li>Enable cookies and site data in browser settings</li>
                    <li>Use normal browsing mode (not private/incognito)</li>
                    <li>Clear browser data to free space</li>
                  </ol>
                </div>
              </div>
            </div>
          </section>

          <!-- FAQs Section -->
          <section id="faqs" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">FAQs</h2>

            <div class="space-y-4">
              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">How secure is the Assessment Uploader? What about data privacy?</h3>
                  <span class="text-xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700 mb-3">The Assessment Uploader is designed with multiple layers of security and privacy protection:</p>
                  
                  <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">🔒 Data Transmission & Storage</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Local-only file writing:</strong> Files written directly to your computer's local folders, never uploaded to cloud servers via browser</li>
                      <li><strong>OneDrive encryption:</strong> Files synced through OneDrive's secure, encrypted channels</li>
                      <li><strong>No external tracking:</strong> No analytics, no cookies, no third-party scripts monitoring your uploads</li>
                      <li><strong>Browser-based permissions:</strong> You explicitly grant folder access permissions via native browser dialog</li>
                    </ul>
                  </div>

                  <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">🔐 Access Control</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Folder permission required:</strong> Browser requires explicit user permission to write to folders</li>
                      <li><strong>Limited to authorized users:</strong> Only personnel with OneDrive folder access can upload</li>
                      <li><strong>PC number tracking:</strong> Each upload tagged with PC number for audit trail</li>
                      <li><strong>No backend authentication:</strong> System runs entirely client-side in browser (privacy-first design)</li>
                    </ul>
                  </div>

                  <div class="bg-purple-50 border-l-4 border-purple-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">💾 File Handling</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Read-only browser access:</strong> Browser only reads PDFs to write them elsewhere, never modifies originals</li>
                      <li><strong>Metadata minimization:</strong> Only PC number stored in metadata files, no personally identifiable info</li>
                      <li><strong>Temporary metadata:</strong> .meta.json files automatically deleted after processing</li>
                      <li><strong>Secure filing:</strong> Processor agent moves files to organized school folders after validation</li>
                    </ul>
                  </div>

                  <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">🛡️ Student Data Protection</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>PDF validation:</strong> Processor agent validates student IDs against encrypted mapping files</li>
                      <li><strong>Data conflict prevention:</strong> System blocks overwriting existing assessment data</li>
                      <li><strong>No data exposure:</strong> Failed uploads moved to Unsorted/ folder, not exposed publicly</li>
                      <li><strong>Audit trail:</strong> Each file tracked with upload source (PC number) and timestamp</li>
                    </ul>
                  </div>

                  <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">⚠️ Security Best Practices</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Use trusted devices:</strong> Don't use the uploader on public or shared computers</li>
                      <li><strong>Verify PC number:</strong> Ensure PC number matches your assigned computer</li>
                      <li><strong>Check OneDrive sync:</strong> Ensure files sync to authorized OneDrive account only</li>
                      <li><strong>Keep browser updated:</strong> Use latest Chrome/Edge version for security patches</li>
                      <li><strong>Lock your screen:</strong> Always lock computer when stepping away during uploads</li>
                      <li><strong>Report issues immediately:</strong> Contact administrators if you notice unexpected behavior</li>
                    </ul>
                  </div>

                  <p class="text-sm text-gray-600 mt-4 italic">
                    <strong>Note:</strong> While the system implements strong security measures, ultimate data security also depends on user practices. Always follow institutional data protection policies and guidelines when handling student assessment data.
                  </p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Do I need internet access to upload?</h3>
                  <span class="text-xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">No! Files are written to local folders. Internet only needed for OneDrive sync (which can happen later).</p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Can I upload while offline?</h3>
                  <span class="text-xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">Yes! Files are written locally. They'll sync to OneDrive when you reconnect.</p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Why Chrome/Edge only?</h3>
                  <span class="text-xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">File System Access API is only available in Chromium browsers. Firefox and Safari don't support it yet.</p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Can I use this on multiple computers?</h3>
                  <span class="text-xl">▼</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">Yes! Configure each computer with its own PC number. Permissions are per-browser on each computer.</p>
                </div>
              </div>
            </div>
          </section>

          <!-- Best Practices Section -->
          <section id="best-practices" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Best Practices</h2>

            <div class="grid md:grid-cols-2 gap-6">
              <div class="diagram-box bg-blue-50 border-blue-300">
                <h3 class="text-lg font-semibold mb-3">📤 For Efficient Uploads</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>✓ Upload 10-20 files at a time</li>
                  <li>✓ Wait for each batch to complete</li>
                  <li>✓ Use standard filename format</li>
                  <li>✓ Check OneDrive status before uploading</li>
                </ul>
              </div>

              <div class="diagram-box bg-green-50 border-green-300">
                <h3 class="text-lg font-semibold mb-3">✅ For Data Quality</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>✓ Verify PC number matches your computer</li>
                  <li>✓ Check file quality before uploading</li>
                  <li>✓ Upload assessments same day</li>
                  <li>✓ Review results in Checking System</li>
                </ul>
              </div>

              <div class="diagram-box bg-yellow-50 border-yellow-300">
                <h3 class="text-lg font-semibold mb-3">🔧 For Troubleshooting</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>✓ Keep browser console open (F12)</li>
                  <li>✓ Test with one file first</li>
                  <li>✓ Document issues with screenshots</li>
                  <li>✓ Clear browser cache weekly</li>
                </ul>
              </div>

              <div class="diagram-box bg-purple-50 border-purple-300">
                <h3 class="text-lg font-semibold mb-3">📋 File Naming</h3>
                <ul class="space-y-2 text-sm text-gray-700">
                  <li>✓ Format: <code>coreID_YYYYMMDD_HH_MM.pdf</code> (Core ID from AITable)</li>
                  <li>✓ Correct format = faster processing</li>
                  <li>✓ Wrong format = rejected by agent</li>
                </ul>
              </div>
            </div>
          </section>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-600 text-sm py-8">
          <p><strong>4Set System</strong> - KeySteps@JC (Phase Two)</p>
          <p class="mt-2">The Education University of Hong Kong | Version 2.0 | October 2025</p>
          <p class="mt-4">For questions or feedback, please contact the project maintainers or open a GitHub issue.</p>
        </footer>
      </main>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="assets/js/user-guides.js"></script>
  <script src="assets/js/spotlight-system.js"></script>
  <script src="assets/js/tooltip-positioner.js"></script>
  
  <!-- Upload Configuration Modal -->
  <div id="uploadConfigModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-[9999]" style="display: none;">
    <div id="modalOverlay" class="absolute inset-0"></div>
    <div class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full mx-4 relative z-[10002]" style="max-height: 90vh; overflow-y: auto;">
      <!-- Modal Header -->
      <div class="sticky top-0 bg-gradient-to-r from-primary to-indigo-600 text-white px-8 py-6 rounded-t-2xl z-10">
        <div class="flex items-center justify-between">
          <h2 class="text-2xl font-bold">Upload Configuration: PC Number & Destination</h2>
          <button 
            onclick="closeUploadConfigModal()" 
            data-spotlight="close"
            class="text-white hover:bg-white/20 rounded-full p-2 transition-all hover:rotate-90"
            title="Close"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <p class="text-sm opacity-90 mt-2">Click on status badges to configure PC number and upload destination</p>
      </div>
      
      <!-- Modal Body -->
      <div class="p-8">
        <!-- Simulated Upload Interface with Status Badges -->
        <div class="border-2 border-gray-300 rounded-lg p-8 bg-gradient-to-br from-blue-50 to-gray-50 mb-6">
          <div class="text-center space-y-6">
            <h3 class="text-xl font-semibold text-gray-800">Configuration Status Panel</h3>
            
            <div class="flex justify-center gap-6 flex-wrap">
              <!-- PC Number Badge -->
              <button 
                class="pc-number-badge px-6 py-3 rounded-full bg-red-100 text-red-700 font-bold text-base border-3 border-red-300 shadow-lg cursor-pointer hover:shadow-xl transition-all relative"
                data-spotlight="button"
                data-tooltip-title="PC Number Badge"
                data-tooltip-description="Click this badge to set your PC number. Required to identify which computer uploaded files. Enter a 3-digit number (e.g., 095)."
              >
                ⚠️ PC Number: Not Set
              </button>
              
              <!-- Upload Destination Badge -->
              <button 
                class="upload-dest-badge px-6 py-3 rounded-full bg-red-100 text-red-700 font-bold text-base border-3 border-red-300 shadow-lg cursor-pointer hover:shadow-xl transition-all relative"
                data-spotlight="button"
                data-tooltip-title="Upload Destination Badge"
                data-tooltip-description="Click this badge to select the destination folder. The browser will ask you to select the 'incoming/' folder where PDFs should be written."
              >
                🔴 Destination: Not Set
              </button>
            </div>
            
            <!-- Help Icon -->
            <div class="flex justify-center mt-4">
              <button 
                class="help-icon p-3 rounded-full bg-gray-100 hover:bg-gray-200 transition-all relative"
                data-spotlight="help"
                data-tooltip-title="Help Icon"
                data-tooltip-description="Click for configuration help and troubleshooting tips"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </button>
            </div>
            
            <!-- Status After Configuration -->
            <div class="mt-8 pt-6 border-t border-gray-300">
              <p class="text-sm text-gray-600 mb-4"><strong>After configuration, badges turn green:</strong></p>
              <div class="flex justify-center gap-6 flex-wrap">
                <div class="px-6 py-3 rounded-full bg-green-100 text-green-700 font-bold text-base border-3 border-green-300 shadow-lg">
                  ✅ PC Number: 095
                </div>
                <div class="px-6 py-3 rounded-full bg-green-100 text-green-700 font-bold text-base border-3 border-green-300 shadow-lg">
                  ✅ Destination: Set
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Instructions -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded">
          <h4 class="font-semibold text-blue-900 mb-3">💡 Configuration Steps</h4>
          <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
            <li><strong>Set PC Number:</strong> Click the red "PC Number" badge → Enter your 3-digit PC number → Click Save</li>
            <li><strong>Set Destination:</strong> Click the red "Destination" badge → Browser will show folder picker → Select the incoming/ folder → Grant permission</li>
            <li><strong>Verify:</strong> Both badges should turn green ✅ when configured correctly</li>
            <li><strong>Upload:</strong> Now you can drag & drop PDFs to upload</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        document.querySelectorAll('.collapsible-header span:last-child').forEach(arrow => {
          const content = arrow.closest('.collapsible-header').nextElementSibling;
          arrow.textContent = content.classList.contains('active') ? '▲' : '▼';
          arrow.classList.add('arrow');
        });
      }, 100);
    });
    
    // Upload Configuration Modal Functions
    let uploadConfigSpotlight = null;
    let uploadConfigTooltipPositioner = null;
    
    function openUploadConfigModal() {
      const modal = document.getElementById('uploadConfigModal');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      
      // Initialize spotlight system
      setTimeout(() => {
        uploadConfigSpotlight = new SpotlightSystem({
          overlaySelector: '#modalOverlay',
          targets: '[data-spotlight="button"], [data-spotlight="help"]',
          closeButton: '[data-spotlight="close"]',
          modalSelector: '#uploadConfigModal',
          padding: 14,
          dimOpacity: 0.55
        });
        uploadConfigSpotlight.enable();
        
        // Initialize tooltip positioner
        uploadConfigTooltipPositioner = new TooltipPositioner({
          tooltipSelector: '.feature-tooltip',
          padding: 10
        });
        
        // Add hover listeners for tooltips
        const spotlightElements = document.querySelectorAll('[data-spotlight="button"], [data-spotlight="help"]');
        spotlightElements.forEach(el => {
          el.addEventListener('mouseenter', function() {
            showUploadConfigTooltip(this);
          });
          el.addEventListener('mouseleave', function() {
            hideUploadConfigTooltip(this);
          });
        });
      }, 100);
    }
    
    function closeUploadConfigModal() {
      const modal = document.getElementById('uploadConfigModal');
      modal.style.display = 'none';
      document.body.style.overflow = '';
      
      // Cleanup spotlight
      if (uploadConfigSpotlight) {
        uploadConfigSpotlight.disable();
        uploadConfigSpotlight = null;
      }
      
      // Remove all tooltips
      document.querySelectorAll('.feature-tooltip').forEach(tooltip => tooltip.remove());
    }
    
    function showUploadConfigTooltip(element) {
      const title = element.getAttribute('data-tooltip-title');
      const description = element.getAttribute('data-tooltip-description');
      
      if (!title || !description) return;
      
      // Create tooltip
      const tooltip = document.createElement('div');
      tooltip.className = 'feature-tooltip';
      tooltip.id = `tooltip-${Math.random().toString(36).substr(2, 9)}`;
      tooltip.innerHTML = `
        <div>${title}</div>
        <div>${description}</div>
      `;
      tooltip.style.display = 'none';
      
      document.body.appendChild(tooltip);
      
      // Position tooltip
      if (uploadConfigTooltipPositioner) {
        uploadConfigTooltipPositioner.positionTooltip(tooltip, element);
      }
      
      // Show tooltip with fade-in
      setTimeout(() => {
        tooltip.style.display = 'block';
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';
      }, 50);
      
      // Store tooltip reference
      element._activeTooltip = tooltip;
    }
    
    function hideUploadConfigTooltip(element) {
      if (element._activeTooltip) {
        element._activeTooltip.remove();
        element._activeTooltip = null;
      }
    }
    
    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && document.getElementById('uploadConfigModal').style.display === 'flex') {
        closeUploadConfigModal();
      }
    });
    
    // Close modal on overlay click
    document.getElementById('modalOverlay')?.addEventListener('click', closeUploadConfigModal);
  </script>
</body>
</html>
