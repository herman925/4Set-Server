<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Guide: Checking System - 4Set System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="assets/js/tailwind.config.js"></script>
  <link rel="stylesheet" href="assets/css/theme_pantone_light_1.css">
  <link rel="stylesheet" href="assets/css/global.css">
  <link rel="stylesheet" href="assets/css/user-guides.css">
  <link rel="stylesheet" href="assets/css/spotlight-system.css">
  <link rel="stylesheet" href="assets/css/tooltip-styles.css">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
    .mermaid {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      mermaid.initialize({ 
        startOnLoad: true,
        theme: 'base',
        themeVariables: {
          primaryColor: '#4A90E2',
          primaryTextColor: '#1F2937',
          primaryBorderColor: '#2E5C8A',
          lineColor: '#6B7280',
          secondaryColor: '#E8F5E9',
          tertiaryColor: '#FFF3E0',
          edgeLabelBackground: '#ffffff',
          textColor: '#1F2937',
          mainBkg: '#ffffff',
          nodeBorder: '#6B7280'
        }
      });
    });
  </script>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <a href="index.html" class="text-2xl font-bold" style="color: var(--primary)">4Set System</a>
          <span class="text-gray-400">|</span>
          <h1 class="text-xl font-semibold text-gray-700">User Guide: Checking System</h1>
        </div>
        <div class="flex items-center gap-3">
          <a href="quick_start_guide.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Quick Start Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 20V10"></path>
              <path d="M18 20V4"></path>
              <path d="M6 20v-4"></path>
            </svg>
          </a>
          <a href="user_guide_uploader.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Assessment Uploader Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
          </a>
          <a href="guide_homepage.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Back to Guide Homepage">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
          </a>
          <a href="index.html" class="text-gray-600 hover:text-primary transition p-2 rounded-lg hover:bg-gray-100" title="Back to System Home">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container mx-auto px-6 py-8">
    <div class="flex gap-8">
      <!-- Sidebar Navigation -->
      <aside class="sidebar w-64 flex-shrink-0">
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-lg font-bold mb-4" style="color: var(--primary)">Table of Contents</h2>
          <nav class="space-y-2">
            <a href="#overview" class="toc-link block text-sm text-gray-700 py-1">I. Overview</a>
            <a href="#getting-started" class="toc-link block text-sm text-gray-700 py-1">II. Getting Started</a>
            <a href="#navigation" class="toc-link block text-sm text-gray-700 py-1">III. Navigation Guide</a>
            <a href="#data-views" class="toc-link block text-sm text-gray-700 py-1">IV. Understanding Data Views</a>
            <a href="#status-indicators" class="toc-link block text-sm text-gray-700 py-1">V. Status Indicators</a>
            <a href="#filters" class="toc-link block text-sm text-gray-700 py-1">VI. Filters and Search</a>
            <a href="#export" class="toc-link block text-sm text-gray-700 py-1">VII. Data Export</a>
            <a href="#cache" class="toc-link block text-sm text-gray-700 py-1">VIII. Cache Management</a>
            <a href="#troubleshooting" class="toc-link block text-sm text-gray-700 py-1">IX. Troubleshooting</a>
            <a href="#faqs" class="toc-link block text-sm text-gray-700 py-1">X. FAQs</a>
            <a href="#best-practices" class="toc-link block text-sm text-gray-700 py-1">XI. Best Practices</a>
          </nav>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="flex-1 max-w-4xl">
        <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
          <!-- Document Info -->
          <div class="mb-8 pb-6 border-b border-gray-200">
            <div class="flex flex-wrap gap-4 text-sm text-gray-600">
              <div><strong>Version:</strong> 1.0</div>
              <div><strong>Last Updated:</strong> October 16, 2025</div>
              <div><strong>Target Users:</strong> Research assistants, project managers, data quality administrators</div>
            </div>
          </div>

          <!-- Overview Section -->
          <section id="overview" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">I</span>
              Overview
            </h2>
            
            <!-- Source Note -->
            <div class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
              <p class="text-sm text-gray-700">
                üìÑ <strong>Markdown Source:</strong> This guide is also available in markdown format at 
                <a href="PRDs/checking_system_user_guide_prd.md" class="text-blue-600 hover:underline font-mono">PRDs/checking_system_user_guide_prd.md</a>
              </p>
            </div>
            
            <p class="text-gray-700 mb-6 text-lg leading-relaxed">
              The <strong>4Set Checking System</strong> is a web-based dashboard that monitors and validates assessment data uploaded to Jotform. It provides a comprehensive view of data completeness, quality, and accuracy across all assessment submissions.
            </p>

            <h3 class="text-2xl font-semibold mb-4 mt-8">What It Does</h3>
            
            <p class="text-gray-700 mb-4">The Checking System serves <strong>two critical verification functions:</strong></p>

            <div class="grid md:grid-cols-2 gap-6 my-6">
              <div class="diagram-box">
                <h4 class="text-xl font-semibold mb-3" style="color: var(--primary)">A. Display Uploaded Data Accurately</h4>
                <ul class="space-y-2 text-gray-700">
                  <li>‚úì Shows exactly what test administrators recorded and uploaded</li>
                  <li>‚úì Reflects manual decisions made during assessments</li>
                  <li>‚úì Provides complete visibility into the database</li>
                  <li>‚úì Serves as the "source of truth" for uploaded data</li>
                </ul>
              </div>

              <div class="diagram-box">
                <h4 class="text-xl font-semibold mb-3" style="color: var(--primary)">B. Validate Through Recalculation</h4>
                <ul class="space-y-2 text-gray-700">
                  <li>‚úì Recalculates termination rules based on actual responses</li>
                  <li>‚úì Compares recorded decisions vs. system calculations</li>
                  <li>‚úì Identifies data quality issues and recording errors</li>
                  <li>‚úì Alerts administrators to inconsistencies</li>
                </ul>
              </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Key Questions Answered</h3>

            <div class="grid md:grid-cols-2 gap-6 my-6">
              <div class="diagram-box">
                <h4 class="text-lg font-semibold mb-3">üìä DATA COMPLETENESS</h4>
                <ul class="space-y-1 text-gray-700 ml-4">
                  <li>‚Ä¢ How many questions are unanswered?</li>
                  <li>‚Ä¢ Which specific questions are missing?</li>
                  <li>‚Ä¢ Are there gaps in required fields?</li>
                </ul>
              </div>

              <div class="diagram-box">
                <h4 class="text-lg font-semibold mb-3">‚úÖ ADMINISTRATOR ACCURACY</h4>
                <ul class="space-y-1 text-gray-700 ml-4">
                  <li>‚Ä¢ Did they mark termination correctly?</li>
                  <li>‚Ä¢ Do records match calculations?</li>
                  <li>‚Ä¢ Are there any data entry errors?</li>
                </ul>
              </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Why This Matters</h3>

            <p class="text-gray-700 mb-4">
              The Checking System recognizes that <strong>termination values are RECORDS, not calculations</strong>:
            </p>

            <div class="diagram-box bg-blue-50 border-blue-300">
              <div class="text-center text-gray-800">
                <div class="mb-4">
                  <div class="font-semibold mb-2">Test Administrator ‚Üí Records ‚Üí <span class="status-badge status-info">Termination Decision</span></div>
                  <div class="font-semibold mb-2">System ‚Üí Calculates ‚Üí <span class="status-badge status-info">Expected Termination</span></div>
                </div>
                <div class="text-3xl mb-2">‚¨áÔ∏è</div>
                <div class="font-semibold mb-4">Compare for Validation</div>
                <div class="flex justify-center gap-8">
                  <div>
                    <span class="status-badge status-complete">‚úÖ Match</span>
                    <div class="text-sm mt-2">Verified</div>
                  </div>
                  <div>
                    <span class="status-badge status-warning">‚ö†Ô∏è Mismatch</span>
                    <div class="text-sm mt-2">Needs Review</div>
                  </div>
                </div>
              </div>
            </div>

            <p class="text-gray-700 mt-6">This dual approach provides:</p>
            <ol class="list-decimal ml-6 space-y-2 text-gray-700 mt-4">
              <li>What was officially recorded (human decision)</li>
              <li>What the data says (system validation)</li>
              <li>Ability to catch errors and data quality issues</li>
              <li>Complete audit trail</li>
            </ol>
            
            <!-- Key UI Elements Section -->
            <h3 class="text-2xl font-semibold mb-4 mt-12">Key UI Elements at a Glance</h3>
            
            <p class="text-gray-700 mb-6">The Checking System uses color-coded visual elements to convey information quickly. Here are the key UI components you'll see:</p>
            
            <div class="bg-white border-2 border-gray-300 rounded-lg p-6 mb-6 shadow-lg">
              <h4 class="font-semibold mb-4 text-center text-lg border-b pb-2">Status Badges Reference</h4>
              
              <div class="grid md:grid-cols-2 gap-4">
                <div class="flex items-center gap-3 p-3 bg-green-50 rounded border border-green-200">
                  <span class="status-badge status-complete text-2xl">‚úÖ</span>
                  <div>
                    <div class="font-semibold text-green-800">Complete</div>
                    <div class="text-xs text-gray-600">All data validated</div>
                  </div>
                </div>
                
                <div class="flex items-center gap-3 p-3 bg-yellow-50 rounded border border-yellow-200">
                  <span class="status-badge status-warning text-2xl">‚ö†Ô∏è</span>
                  <div>
                    <div class="font-semibold text-yellow-800">Warning</div>
                    <div class="text-xs text-gray-600">Review needed</div>
                  </div>
                </div>
                
                <div class="flex items-center gap-3 p-3 bg-red-50 rounded border border-red-200">
                  <span class="status-badge status-error text-2xl">üî¥</span>
                  <div>
                    <div class="font-semibold text-red-800">Error/Incomplete</div>
                    <div class="text-xs text-gray-600">Missing data</div>
                  </div>
                </div>
                
                <div class="flex items-center gap-3 p-3 bg-blue-50 rounded border border-blue-200">
                  <span class="status-badge status-info text-2xl">üîµ</span>
                  <div>
                    <div class="font-semibold text-blue-800">Info</div>
                    <div class="text-xs text-gray-600">Additional information</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="bg-white border-2 border-gray-300 rounded-lg p-6 mb-6 shadow-lg">
              <h4 class="font-semibold mb-4 text-center text-lg border-b pb-2">Interactive Buttons & Pills</h4>
              
              <div class="space-y-4">
                <!-- Cache Status Pills -->
                <div class="border-l-4 border-blue-500 pl-4 py-2">
                  <div class="font-semibold mb-2 text-sm text-gray-700">Cache Status (Top of page)</div>
                  <div class="flex flex-wrap gap-3">
                    <div class="px-4 py-2 rounded-full bg-red-100 text-red-700 font-semibold text-sm border border-red-300 cursor-pointer hover:bg-red-200 transition shadow-sm">
                      üî¥ System Not Ready
                    </div>
                    <div class="px-4 py-2 rounded-full bg-orange-100 text-orange-700 font-semibold text-sm border border-orange-300 shadow-sm">
                      üü† Syncing 45%
                    </div>
                    <div class="px-4 py-2 rounded-full bg-green-100 text-green-700 font-semibold text-sm border border-green-300 cursor-pointer hover:bg-green-200 transition shadow-sm">
                      üü¢ System Ready
                    </div>
                  </div>
                </div>
                
                <!-- Navigation Buttons -->
                <div class="border-l-4 border-purple-500 pl-4 py-2">
                  <div class="font-semibold mb-2 text-sm text-gray-700">Action Buttons (Homepage)</div>
                  <div class="space-y-2">
                    <button class="border border-gray-300 rounded px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50 cursor-pointer transition shadow-sm flex items-center gap-2 w-full justify-center">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                      </svg>
                      Add filter
                    </button>
                    <button class="border border-gray-300 rounded px-5 py-2 text-sm font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 cursor-pointer transition shadow-sm w-full">
                      Clear All
                    </button>
                    <button class="border border-gray-300 rounded px-6 py-2 text-sm font-semibold bg-primary text-white hover:bg-primary/90 cursor-pointer transition shadow-sm w-full">
                      Start Checking
                    </button>
                  </div>
                </div>
                
                <!-- Collapsible Sections -->
                <div class="border-l-4 border-green-500 pl-4 py-2">
                  <div class="font-semibold mb-2 text-sm text-gray-700">Collapsible Sections</div>
                  <div class="border border-gray-300 rounded">
                    <div class="bg-gray-100 px-4 py-3 cursor-pointer hover:bg-gray-200 transition flex justify-between items-center">
                      <span class="font-semibold">Click to expand/collapse</span>
                      <span class="text-xl">‚ñº</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
              <p class="text-sm text-gray-700">
                <strong>üí° Tip:</strong> Hover over interactive elements to see hover effects. Click status pills, cards, and headers to navigate or expand details.
              </p>
            </div>
          </section>

          <!-- Getting Started Section -->
          <section id="getting-started" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">II</span>
              Getting Started
            </h2>

            <h3 class="text-2xl font-semibold mb-4">Quick Start (5 Steps)</h3>

            <div class="diagram-box bg-green-50 border-green-300">
              <div class="space-y-3 text-gray-800">
                <div class="flex items-center gap-3">
                  <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">1</div>
                  <div>Open <code>checking_system_home.html</code></div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">2</div>
                  <div>Enter system password</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">3</div>
                  <div>Navigate hierarchy (District ‚Üí Group ‚Üí School ‚Üí Class ‚Üí Student)</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">4</div>
                  <div>Review status indicators</div>
                </div>
                <div class="flex items-center gap-3">
                  <div class="bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">5</div>
                  <div>Export reports as needed</div>
                </div>
              </div>
            </div>

            <div class="collapsible-section mt-6">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">System Access</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <h4 class="text-lg font-semibold mb-3">Opening the Checking System</h4>
                
                <p class="mb-4"><strong>Method 1: Direct File Access</strong></p>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-6">
                  <li>Navigate to repository folder</li>
                  <li>Open <code>checking_system_home.html</code> in Chrome/Edge</li>
                  <li>Enter system password when prompted</li>
                </ol>

                <p class="mb-4"><strong>Method 2: GitHub Pages</strong> (if hosted)</p>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li>Visit the GitHub Pages URL</li>
                  <li>Click "Checking System" from navigation</li>
                  <li>Enter password</li>
                </ol>

                <h4 class="text-lg font-semibold mb-3 mt-6">System Password</h4>
                <p class="text-gray-700 mb-3">The system password is required to:</p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700 mb-4">
                  <li>Decrypt credential bundles</li>
                  <li>Access Jotform API</li>
                  <li>View student data</li>
                </ul>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                  <p class="text-sm text-gray-700"><strong>If you don't have the password:</strong></p>
                  <ul class="list-disc ml-6 text-sm text-gray-700 mt-2 space-y-1">
                    <li>Contact your project administrator</li>
                    <li>Password is set during system setup</li>
                    <li>Different from individual user passwords</li>
                  </ul>
                </div>

                <p class="text-sm text-gray-600"><strong>Security Features:</strong></p>
                <ul class="list-disc ml-6 text-sm text-gray-600 space-y-1 mt-2">
                  <li>Password stored in encrypted <code>assets/credentials.enc</code></li>
                  <li>Credentials cached in browser session</li>
                  <li>Auto-logout after inactivity</li>
                  <li>No password saved in browser history</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">First-Time Setup</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="text-gray-700 mb-4">No setup required! The Checking System works immediately after:</p>
                <ul class="space-y-2 text-gray-700">
                  <li>‚úÖ System password is entered</li>
                  <li>‚úÖ Jotform credentials are valid</li>
                  <li>‚úÖ Browser has internet connection</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Navigation Guide Section -->
          <section id="navigation" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">III</span>
              Navigation Guide
            </h2>

            <h3 class="text-2xl font-semibold mb-4">System Hierarchy</h3>
            
            <p class="text-gray-700 mb-4">The Checking System organizes data in a 5-level hierarchy:</p>

            <!-- Visual Hierarchy Diagram -->
            <div class="bg-gradient-to-br from-purple-50 to-blue-50 p-8 rounded-lg border-2 border-purple-200 mb-6">
              <div class="flex flex-col space-y-6">
                <!-- Level 1: District -->
                <div class="flex items-center gap-4">
                  <div class="bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg min-w-[200px] text-center">
                    1Ô∏è‚É£ District (Âú∞ÂçÄ)
                  </div>
                  <div class="flex-1 text-sm text-gray-600 italic">
                    Top level: Shatin, Tuen Mun, etc.
                  </div>
                </div>
                
                <div class="ml-8 border-l-4 border-purple-300 pl-4">
                  <!-- Level 2: Group -->
                  <div class="flex items-center gap-4 mb-4">
                    <div class="bg-purple-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg min-w-[200px] text-center">
                      2Ô∏è‚É£ Group (ÁµÑÂà•)
                    </div>
                    <div class="flex-1 text-sm text-gray-600 italic">
                      Project groups: 1, 2, 3, 4, 5
                    </div>
                  </div>
                  
                  <div class="ml-8 border-l-4 border-purple-300 pl-4">
                    <!-- Level 3: School -->
                    <div class="flex items-center gap-4 mb-4">
                      <div class="bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg min-w-[200px] text-center">
                        3Ô∏è‚É£ School (Â≠∏Ê†°)
                      </div>
                      <div class="flex-1 text-sm text-gray-600 italic">
                        Individual schools: S023, S045, etc.
                      </div>
                    </div>
                    
                    <div class="ml-8 border-l-4 border-blue-300 pl-4">
                      <!-- Level 4: Class -->
                      <div class="flex items-center gap-4 mb-4">
                        <div class="bg-blue-400 text-white px-6 py-3 rounded-lg font-semibold shadow-lg min-w-[200px] text-center">
                          4Ô∏è‚É£ Class (Áè≠Á¥ö)
                        </div>
                        <div class="flex-1 text-sm text-gray-600 italic">
                          Classrooms: C-023-01, C-023-02, etc.
                        </div>
                      </div>
                      
                      <div class="ml-8 border-l-4 border-blue-300 pl-4">
                        <!-- Level 5: Student -->
                        <div class="flex items-center gap-4">
                          <div class="bg-green-500 text-white px-6 py-3 rounded-lg font-semibold shadow-lg min-w-[200px] text-center">
                            5Ô∏è‚É£ Student (Â≠∏Áîü)
                          </div>
                          <div class="flex-1 text-sm text-gray-600 italic">
                            Individual students: C10207, C10208, etc.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="mt-6 pt-4 border-t border-purple-200">
                <p class="text-sm text-gray-700 italic">
                  <strong>Navigation:</strong> Click any level to drill down. Use breadcrumbs to move back up.
                </p>
              </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Homepage Layout</h3>

            <p class="text-gray-700 mb-4">The Checking System homepage uses a <strong>filter-based navigation system</strong>. Users configure filters to specify what data they want to view, then click "Start Checking" to navigate to the appropriate drill-down level:</p>

            <div class="diagram-box homepage-layout-preview-container" style="position: relative;">
              <!-- "See More" button - shown on hover -->
              <button 
                class="homepage-layout-enlarge-btn" 
                onclick="openHomepageLayoutModal()"
                style="position: absolute; top: 12px; right: 12px; z-index: 50; background-color: rgba(43, 57, 144, 0.95); color: white; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.2s ease; cursor: pointer; border: none;"
                title="See More"
              >
                <span style="display: flex; align-items: center; gap: 6px;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M9 21H3v-6"/><path d="M21 3l-7 7"/><path d="M3 21l7-7"/></svg>
                  See More
                </span>
              </button>
              
              <div class="border border-gray-300 rounded p-4">
                <div class="bg-primary text-white p-3 rounded mb-3 text-center font-bold text-sm">
                  üîç Checking System
                </div>
                <div class="text-xs text-gray-600 mb-4 text-center">
                  Search and analyse submitted data from every angle
                </div>
                
                <!-- System Status Pills -->
                <div class="mb-3 p-3 bg-gray-50 rounded border border-gray-200">
                  <div class="text-xs font-semibold text-gray-600 mb-2">System Status & Cache Management</div>
                  <div class="flex gap-2 flex-wrap items-center">
                    <span class="text-xs px-2 py-1 bg-red-100 text-red-700 rounded-full border border-red-300 font-semibold">üî¥ System Not Ready</span>
                    <span class="text-xs text-gray-500">Last Synced: ‚Äî</span>
                  </div>
                </div>
                
                <!-- Filter Chips Display -->
                <div class="mb-3 p-3 bg-white rounded border border-gray-200">
                  <div class="flex justify-between items-center">
                    <span class="text-xs text-gray-500">No filters applied</span>
                    <span class="text-xs text-gray-500 font-medium">0 filters applied</span>
                  </div>
                </div>
                
                <!-- Configure Filters -->
                <div class="mb-3 p-4 bg-white rounded border-2 border-gray-300">
                  <div class="text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                      <line x1="4" y1="21" x2="4" y2="14"></line>
                      <line x1="4" y1="10" x2="4" y2="3"></line>
                      <line x1="12" y1="21" x2="12" y2="12"></line>
                      <line x1="12" y1="8" x2="12" y2="3"></line>
                      <line x1="20" y1="21" x2="20" y2="16"></line>
                      <line x1="20" y1="12" x2="20" y2="3"></line>
                      <line x1="1" y1="14" x2="7" y2="14"></line>
                      <line x1="9" y1="8" x2="15" y2="8"></line>
                      <line x1="17" y1="16" x2="23" y2="16"></line>
                    </svg>
                    Configure Filters
                  </div>
                  <div class="space-y-2">
                    <div class="p-2 bg-blue-50 rounded border border-blue-200 text-xs text-gray-700">
                      <strong>Filter Rules:</strong> District and Group are independent. School ‚Üí Class ‚Üí Student hierarchy.
                    </div>
                    <div class="pt-1">
                      <button class="flex items-center gap-1 text-xs font-medium text-primary hover:underline">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                          <circle cx="12" cy="12" r="10"></circle>
                          <line x1="12" y1="8" x2="12" y2="16"></line>
                          <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Add filter
                      </button>
                    </div>
                  </div>
                  <div class="mt-3 pt-3 border-t border-gray-200 flex justify-end gap-2">
                    <button class="text-xs px-4 py-1.5 bg-gray-200 text-gray-700 rounded-full font-semibold">Clear All</button>
                    <button class="text-xs px-5 py-1.5 bg-gray-300 text-gray-500 rounded-full font-semibold cursor-not-allowed" disabled>Start Checking</button>
                  </div>
                </div>
                
                <!-- Recent Checks -->
                <div class="p-3 bg-gray-50 rounded border border-gray-200">
                  <div class="text-xs font-semibold text-gray-600 uppercase tracking-wider mb-1 flex items-center gap-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Recent Checks
                  </div>
                  <div class="text-xs text-gray-500">No recent checks</div>
                </div>
              </div>
              <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 rounded">
                <p class="text-sm text-gray-700">
                  <strong>üí° How It Works:</strong> Configure one or more filters (District, Group, School, Class, Student, or Grade), then click "Start Checking" to navigate to the appropriate view with your filters applied.
                </p>
              </div>
            </div>
            
            <style>
              .homepage-layout-preview-container:hover .homepage-layout-enlarge-btn {
                opacity: 1 !important;
              }
              .homepage-layout-enlarge-btn:hover {
                background-color: rgba(43, 57, 144, 1) !important;
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
              }
            </style>

            <h3 class="text-2xl font-semibold mb-4 mt-8">Navigation Breadcrumbs</h3>

            <div class="diagram-box bg-blue-50 border-blue-300">
              <div class="text-sm text-gray-700 mb-2">At any level, breadcrumbs show your location:</div>
              <div class="bg-white border rounded p-3 font-mono text-sm text-gray-800">
                <a href="#" class="text-blue-600 hover:underline">Home</a> &gt;
                <a href="#" class="text-blue-600 hover:underline">Shatin</a> &gt;
                <a href="#" class="text-blue-600 hover:underline">Group 1</a> &gt;
                <a href="#" class="text-blue-600 hover:underline">School S023</a> &gt;
                <a href="#" class="text-blue-600 hover:underline">Class C-023-03</a> &gt;
                <span>Student C10207</span>
              </div>
              <div class="text-sm text-gray-600 mt-3">
                <strong>Tips:</strong>
                <ul class="list-disc ml-6 mt-2 space-y-1">
                  <li>Click any breadcrumb to jump back to that level</li>
                  <li>Use browser back button to go back one level</li>
                  <li>Breadcrumbs show full navigation path</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Data Views Section -->
          <section id="data-views" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">IV</span>
              Understanding Data Views
            </h2>

            <p class="text-gray-700 mb-6">The Checking System provides <strong>five hierarchical data views</strong> that allow you to drill down from the broadest overview to individual student details:</p>

            <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg border-2 border-purple-200 mb-6">
              <ol class="space-y-2 text-gray-800">
                <li class="flex items-center gap-3">
                  <span class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">1</span>
                  <div><strong>District View</strong> - High-level overview by geographic region</div>
                </li>
                <li class="flex items-center gap-3">
                  <span class="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">2</span>
                  <div><strong>Group View</strong> - Overview by project group assignment</div>
                </li>
                <li class="flex items-center gap-3">
                  <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">3</span>
                  <div><strong>School View</strong> - Detailed view of individual school performance</div>
                </li>
                <li class="flex items-center gap-3">
                  <span class="bg-blue-400 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">4</span>
                  <div><strong>Class View</strong> - All students within a specific classroom</div>
                </li>
                <li class="flex items-center gap-3">
                  <span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm">5</span>
                  <div><strong>Student View</strong> - Complete assessment details for one student</div>
                </li>
              </ol>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">District View</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-4"><strong>Purpose:</strong> High-level overview of all districts</p>
                
                <table>
                  <thead>
                    <tr>
                      <th>District</th>
                      <th>Schools</th>
                      <th>Students</th>
                      <th>Complete</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Shatin</td>
                      <td>35</td>
                      <td>450</td>
                      <td><span class="status-badge status-complete">85%</span></td>
                    </tr>
                    <tr>
                      <td>Sham Shui Po</td>
                      <td>28</td>
                      <td>380</td>
                      <td><span class="status-badge status-warning">78%</span></td>
                    </tr>
                    <tr>
                      <td>Kowloon City</td>
                      <td>22</td>
                      <td>295</td>
                      <td><span class="status-badge status-complete">92%</span></td>
                    </tr>
                  </tbody>
                </table>

                <p class="mt-4"><strong>Key Metrics:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li><strong>Schools:</strong> Number of schools in district</li>
                  <li><strong>Students:</strong> Total students across all schools</li>
                  <li><strong>Complete:</strong> Percentage with all tasks done</li>
                </ul>

                <p class="mt-4"><strong>Actions:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Click district name to drill down</li>
                  <li>Sort by clicking column headers</li>
                  <li>Filter by completion status</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">Group View</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-4"><strong>Purpose:</strong> Overview by project group assignment</p>
                
                <table>
                  <thead>
                    <tr>
                      <th>Group</th>
                      <th>Schools</th>
                      <th>Students</th>
                      <th>Complete</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Group 1</td>
                      <td>18</td>
                      <td>240</td>
                      <td><span class="status-badge status-complete">88%</span></td>
                    </tr>
                    <tr>
                      <td>Group 2</td>
                      <td>22</td>
                      <td>295</td>
                      <td><span class="status-badge status-complete">91%</span></td>
                    </tr>
                    <tr>
                      <td>Group 3</td>
                      <td>15</td>
                      <td>198</td>
                      <td><span class="status-badge status-warning">75%</span></td>
                    </tr>
                    <tr>
                      <td>Group 4</td>
                      <td>20</td>
                      <td>267</td>
                      <td><span class="status-badge status-complete">82%</span></td>
                    </tr>
                    <tr>
                      <td>Group 5</td>
                      <td>10</td>
                      <td>125</td>
                      <td><span class="status-badge status-complete">86%</span></td>
                    </tr>
                  </tbody>
                </table>

                <p class="mt-4"><strong>Key Metrics:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li><strong>Schools:</strong> Number of schools in the project group</li>
                  <li><strong>Students:</strong> Total students across all schools in the group</li>
                  <li><strong>Complete:</strong> Percentage with all tasks done</li>
                </ul>

                <p class="mt-4"><strong>Actions:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Click group name to view all schools in that group</li>
                  <li>Sort by clicking column headers</li>
                  <li>Compare progress across different project groups</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">School View</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-4"><strong>Purpose:</strong> Detailed view of individual school</p>

                <div class="bg-gray-50 border rounded p-4 mb-4">
                  <div class="text-lg font-semibold mb-2">School: S023</div>
                  <div class="text-sm text-gray-600 mb-1">Name: ABC Primary School</div>
                  <div class="text-sm text-gray-600 mb-3">Chinese: ABCÂ∞èÂ≠∏</div>
                  <div class="grid grid-cols-2 gap-4 mt-4">
                    <div>
                      <div class="text-xs text-gray-500">Total Students</div>
                      <div class="text-2xl font-bold">75</div>
                    </div>
                    <div>
                      <div class="text-xs text-gray-500">Completed</div>
                      <div class="text-2xl font-bold text-green-600">62 (83%)</div>
                    </div>
                  </div>
                </div>

                <p class="mt-4"><strong>View Modes:</strong></p>
                <div class="space-y-3 mt-3">
                  <div class="border-l-4 border-blue-500 pl-4">
                    <div class="font-semibold">By Class (Default)</div>
                    <ul class="text-sm text-gray-700 mt-1 space-y-1">
                      <li>‚Ä¢ Shows all classes in the school</li>
                      <li>‚Ä¢ Displays Set 1-4 completion status</li>
                      <li>‚Ä¢ Includes "ÁÑ°Áè≠Á¥ö" for unassigned students</li>
                    </ul>
                  </div>
                  <div class="border-l-4 border-green-500 pl-4">
                    <div class="font-semibold">By Student</div>
                    <ul class="text-sm text-gray-700 mt-1 space-y-1">
                      <li>‚Ä¢ Shows unique students across all classes</li>
                      <li>‚Ä¢ Two sub-modes: By Set / By Task</li>
                      <li>‚Ä¢ Horizontally scrollable for many tasks</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">Class View</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-4"><strong>Purpose:</strong> All students within a specific classroom</p>

                <div class="bg-gray-50 border rounded p-4 mb-4">
                  <div class="text-lg font-semibold mb-2">Class: C-023-03</div>
                  <div class="text-sm text-gray-600 mb-1">School: S023 - ABC Primary School</div>
                  <div class="text-sm text-gray-600 mb-3">Grade: K1</div>
                  <div class="grid grid-cols-2 gap-4 mt-4">
                    <div>
                      <div class="text-xs text-gray-500">Total Students</div>
                      <div class="text-2xl font-bold">25</div>
                    </div>
                    <div>
                      <div class="text-xs text-gray-500">Completed</div>
                      <div class="text-2xl font-bold text-green-600">21 (84%)</div>
                    </div>
                  </div>
                </div>

                <p class="mt-4"><strong>What You See:</strong></p>
                <table class="mt-3">
                  <thead>
                    <tr>
                      <th>Core ID</th>
                      <th>Name</th>
                      <th>Tasks</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>C10207</td>
                      <td>Èô≥Â∞èÊòé</td>
                      <td>14/14</td>
                      <td><span class="status-badge status-complete">‚úÖ Complete</span></td>
                    </tr>
                    <tr>
                      <td>C10208</td>
                      <td>ÊùéÂ∞èËèØ</td>
                      <td>12/14</td>
                      <td><span class="status-badge status-warning">‚ö†Ô∏è In Progress</span></td>
                    </tr>
                    <tr>
                      <td>C10209</td>
                      <td>ÁéãÂ∞èÁæé</td>
                      <td>3/14</td>
                      <td><span class="status-badge status-error">üî¥ Incomplete</span></td>
                    </tr>
                  </tbody>
                </table>

                <p class="mt-4"><strong>Key Information:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li><strong>Student identification:</strong> Core ID and Name</li>
                  <li><strong>Task completion count:</strong> Number of tasks completed out of total</li>
                  <li><strong>Overall status indicator:</strong> Visual status for quick assessment</li>
                  <li><strong>Sortable columns:</strong> Click headers to sort by any column</li>
                </ul>

                <p class="mt-4"><strong>Status Indicators:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>‚úÖ <strong>Green:</strong> All tasks complete, no issues</li>
                  <li>‚ö†Ô∏è <strong>Yellow:</strong> Some tasks complete, needs review</li>
                  <li>üî¥ <strong>Red:</strong> Incomplete, missing data</li>
                  <li>‚≠ï <strong>Grey:</strong> Not started</li>
                </ul>

                <p class="mt-4"><strong>Actions:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Click student to see detailed assessment view</li>
                  <li>Sort by any column to organize data</li>
                  <li>Filter by status to focus on specific needs</li>
                  <li>Export class report for sharing</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">Student View (Most Detailed)</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-4"><strong>Purpose:</strong> Complete assessment details for one student</p>

                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded">
                  <p class="text-sm text-gray-800">
                    <strong>The 4 Sets Organization:</strong> Assessment tasks are grouped into 4 sets based on the testing protocol. Each set contains specific tasks listed below.
                  </p>
                </div>

                <div class="space-y-4">
                  <div class="border rounded p-4 bg-gradient-to-r from-blue-50 to-white">
                    <div class="font-semibold mb-2 text-lg flex items-center gap-2">
                      <span class="bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">1</span>
                      Set 1 (Á¨¨‰∏ÄÁµÑ)
                    </div>
                    <div class="space-y-2 ml-8">
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">ERV (English Receptive Vocabulary)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">SYM (Symbolic Reasoning)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">Theory of Mind</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-warning">‚ö†Ô∏è</span>
                        <span class="text-sm">Chinese Word Reading</span>
                      </div>
                    </div>
                  </div>

                  <div class="border rounded p-4 bg-gradient-to-r from-green-50 to-white">
                    <div class="font-semibold mb-2 text-lg flex items-center gap-2">
                      <span class="bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">2</span>
                      Set 2 (Á¨¨‰∫åÁµÑ)
                    </div>
                    <div class="space-y-2 ml-8">
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">TEC (Male/Female - gender-conditional)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">Math Pattern</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">CCM (Cross-Cultural Mathematics)</span>
                      </div>
                    </div>
                  </div>

                  <div class="border rounded p-4 bg-gradient-to-r from-purple-50 to-white">
                    <div class="font-semibold mb-2 text-lg flex items-center gap-2">
                      <span class="bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">3</span>
                      Set 3 (Á¨¨‰∏âÁµÑ)
                    </div>
                    <div class="space-y-2 ml-8">
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">HTKS (Head-Toe-Knee-Shoulder)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">EPN (Early Problem Numeracy)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-error">üî¥</span>
                        <span class="text-sm">CM (Chinese Morphology)</span>
                      </div>
                    </div>
                  </div>

                  <div class="border rounded p-4 bg-gradient-to-r from-amber-50 to-white">
                    <div class="font-semibold mb-2 text-lg flex items-center gap-2">
                      <span class="bg-amber-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">4</span>
                      Set 4 (Á¨¨ÂõõÁµÑ)
                    </div>
                    <div class="space-y-2 ml-8">
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">Fine Motor</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">TGMD (Test of Gross Motor Development)</span>
                      </div>
                      <div class="flex items-center gap-2">
                        <span class="status-badge status-complete">‚úÖ</span>
                        <span class="text-sm">MF (Movement & Fitness)</span>
                      </div>
                    </div>
                  </div>

                  <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded mt-4">
                    <p class="text-sm text-gray-700">
                      <strong>Note:</strong> TEC has two versions (TEC_Male and TEC_Female) - only one appears per student based on their gender. Click "Expand each task for details" to see question-level information.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Status Indicators Section -->
          <section id="status-indicators" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">V</span>
              Status Indicators and Meanings
            </h2>
            
            <!-- Visual Status Decision Flowchart -->
            <div class="bg-gradient-to-br from-gray-50 to-blue-50 p-6 rounded-lg border-2 border-gray-300 mb-8">
              <h3 class="font-semibold mb-6 text-center text-lg">Status Indicator Logic Flowchart</h3>
              
              <div class="mermaid">
flowchart TD
    Start([Task Submitted]) --> Q1{Any questions<br/>answered?}
    
    Q1 -->|NO| Grey[‚≠ï GREY<br/>Not Started]
    Q1 -->|YES| Q2{All required<br/>questions<br/>answered?}
    
    Q2 -->|NO| Red[üî¥ RED<br/>Incomplete]
    Q2 -->|YES| Q3{Post-termination<br/>answers<br/>detected?}
    
    Q3 -->|YES| Yellow[‚ö†Ô∏è YELLOW<br/>Post-termination<br/>Activity]
    Q3 -->|NO| Green[‚úÖ GREEN<br/>Complete]
    
    style Start fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Grey fill:#E0E0E0,stroke:#9E9E9E,color:#333
    style Red fill:#FFE0E0,stroke:#E57373,color:#C62828
    style Yellow fill:#FFF9E0,stroke:#FFD54F,color:#F57C00
    style Green fill:#E0F7E0,stroke:#81C784,color:#2E7D32
    style Q1 fill:#F3E5F5,stroke:#9C27B0,color:#4A148C
    style Q2 fill:#FFF3E0,stroke:#FF9800,color:#E65100
    style Q3 fill:#E8F5E9,stroke:#4CAF50,color:#1B5E20
              </div>
              
              <div class="mt-6 p-4 bg-white rounded border">
                <p class="text-sm font-semibold mb-2">Decision Logic:</p>
                <ol class="text-xs text-gray-700 space-y-1 ml-4">
                  <li>1. <strong>Grey (‚≠ï):</strong> Zero questions answered ‚Üí Task not started</li>
                  <li>2. <strong>Red (üî¥):</strong> Some but not all required questions answered ‚Üí Incomplete</li>
                  <li>3. <strong>Yellow (‚ö†Ô∏è):</strong> All required questions answered BUT answers exist after termination point ‚Üí Post-termination activity</li>
                  <li>4. <strong>Green (‚úÖ):</strong> All required questions answered AND no post-termination answers ‚Üí Complete and verified</li>
                </ol>
              </div>
            </div>

            <div class="space-y-4">
              <div class="diagram-box bg-green-50 border-green-300">
                <div class="flex items-center gap-4 mb-3">
                  <span class="status-badge status-complete text-xl">‚úÖ</span>
                  <h3 class="text-xl font-semibold">Green - Complete & Verified</h3>
                </div>
                <p class="text-gray-700 mb-2"><strong>Meaning:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>All questions answered</li>
                  <li>Termination rules verified (if applicable)</li>
                  <li>No data quality issues detected</li>
                  <li>Recorded values match calculations</li>
                </ul>
                <p class="mt-3 text-gray-700"><strong>What to do:</strong> Nothing - task is complete and accurate</p>
              </div>

              <div class="diagram-box bg-yellow-50 border-yellow-300">
                <div class="flex items-center gap-4 mb-3">
                  <span class="status-badge status-warning text-xl">‚ö†Ô∏è</span>
                  <h3 class="text-xl font-semibold">Yellow - Post-Termination Activity (Needs Review)</h3>
                </div>
                <p class="text-gray-700 mb-2"><strong>Meaning:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>All required questions answered BUT</li>
                  <li>Answers were recorded AFTER termination point</li>
                  <li>Post-termination data detected (data quality issue)</li>
                  <li>Administrator continued testing beyond where termination should have occurred</li>
                </ul>
                <p class="mt-3 text-gray-700"><strong>What to do:</strong></p>
                <ol class="list-decimal ml-6 space-y-1 text-gray-700 mt-2">
                  <li>Expand task details</li>
                  <li>Review termination point and post-termination answers</li>
                  <li>Verify if termination rules were correctly applied</li>
                  <li>Document the issue - post-termination data indicates:
                    <ul class="list-disc ml-6 text-sm mt-1">
                      <li>Administrator may not have recognized termination trigger</li>
                      <li>Testing protocol not followed correctly</li>
                      <li>Possible need for administrator retraining</li>
                    </ul>
                  </li>
                </ol>
                <div class="mt-3 p-3 bg-yellow-100 rounded border border-yellow-300">
                  <p class="text-xs text-gray-700">
                    <strong>Example:</strong> CWR termination triggered at Q24 (10 consecutive incorrect), but student has answers for Q25-Q30 ‚Üí Yellow ‚ö†Ô∏è status
                  </p>
                </div>
              </div>

              <div class="diagram-box bg-red-50 border-red-300">
                <div class="flex items-center gap-4 mb-3">
                  <span class="status-badge status-error text-xl">üî¥</span>
                  <h3 class="text-xl font-semibold">Red - Incomplete</h3>
                </div>
                <p class="text-gray-700 mb-2"><strong>Meaning:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Missing questions (unanswered)</li>
                  <li>Below minimum required</li>
                  <li>Task not fully completed</li>
                </ul>
                <p class="mt-3 text-gray-700"><strong>What to do:</strong></p>
                <ol class="list-decimal ml-6 space-y-1 text-gray-700 mt-2">
                  <li>Check how many questions missing</li>
                  <li>Determine if acceptable (early termination OK)</li>
                  <li>If not terminated: follow up with administrator</li>
                  <li>If terminated correctly: may be OK</li>
                </ol>
              </div>

              <div class="diagram-box bg-gray-50 border-gray-300">
                <div class="flex items-center gap-4 mb-3">
                  <span class="status-badge bg-gray-200 text-gray-700 text-xl">‚≠ï</span>
                  <h3 class="text-xl font-semibold">Grey - Not Started</h3>
                </div>
                <p class="text-gray-700 mb-2"><strong>Meaning:</strong></p>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Task not attempted</li>
                  <li>Zero questions answered</li>
                  <li>No data submitted</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Filters and Search Section -->
          <section id="filters" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">VI</span>
              Filters and Search
            </h2>

            <p class="text-gray-700 mb-6">
              The Checking System homepage features a powerful <strong>Filter Configuration Panel</strong> that allows you to narrow down data before viewing it. This advanced filtering system works independently from the navigation hierarchy.
            </p>

            <!-- Interactive Screenshot: Filter Configuration Panel -->
            <div class="border-2 border-gray-300 rounded-lg overflow-hidden my-6 shadow-lg filter-panel-preview-container" style="position: relative;">
              <!-- "See More" button - shown on hover -->
              <button 
                class="filter-panel-enlarge-btn" 
                onclick="openFilterPanelModal()"
                style="position: absolute; top: 12px; right: 12px; z-index: 50; background-color: rgba(43, 57, 144, 0.95); color: white; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.2s ease; cursor: pointer; border: none;"
                title="See More"
              >
                <span style="display: flex; align-items: center; gap: 6px;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M9 21H3v-6"/><path d="M21 3l-7 7"/><path d="M3 21l7-7"/></svg>
                  See More
                </span>
              </button>
              
              <!-- Preview of filter panel -->
              <div style="padding: 2rem; background: linear-gradient(135deg, #e0e7ff 0%, #f3f4f6 100%);">
                <div class="space-y-4">
                  <div class="font-semibold text-lg text-gray-800 text-center mb-3">Filter Configuration Panel</div>
                  <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
                    <div class="flex flex-wrap gap-2 mb-3">
                      <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold border border-blue-300">
                        District: Shatin <button class="ml-1 hover:text-blue-900">√ó</button>
                      </span>
                      <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold border border-green-300">
                        Grade: K1 <button class="ml-1 hover:text-green-900">√ó</button>
                      </span>
                    </div>
                    <div class="border-t pt-3">
                      <button class="px-4 py-2 bg-primary text-white rounded-lg text-sm font-semibold hover:bg-primary/90 transition">
                        + Add Filter
                      </button>
                    </div>
                  </div>
                  <div class="text-sm text-gray-600 italic text-center">Click to see interactive filter controls</div>
                </div>
              </div>
            </div>
            
            <style>
              .filter-panel-preview-container:hover .filter-panel-enlarge-btn {
                opacity: 1 !important;
              }
              .filter-panel-enlarge-btn:hover {
                background-color: rgba(43, 57, 144, 1) !important;
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
              }
            </style>

            <h3 class="text-2xl font-semibold mb-4">Homepage Filter Panel</h3>

            <div class="diagram-box bg-blue-50 border-blue-300">
              <p class="text-gray-700 mb-4">The filter panel on the homepage includes:</p>
              <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                <li><strong>Filter chips display</strong> - Shows currently active filters</li>
                <li><strong>Configure Filters section</strong> - Add and configure multiple filter criteria</li>
                <li><strong>Filter count indicator</strong> - Shows how many filters are applied</li>
                <li><strong>Recent checks</strong> - Quick access to previously used filter combinations</li>
              </ol>
            </div>

            <div class="collapsible-section mt-6">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">How to Use Filters</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <h4 class="text-lg font-semibold mb-3">Adding Filters</h4>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-6">
                  <li>Click <strong>"Add filter"</strong> button in the Configure Filters section</li>
                  <li>A new filter row appears with dropdown selectors</li>
                  <li>Choose filter type from available options:
                    <ul class="list-disc ml-6 mt-2 space-y-1">
                      <li><strong>District</strong> - Filter by geographic district (e.g., Shatin, Tuen Mun)</li>
                      <li><strong>Group</strong> - Filter by project group (1-5)</li>
                      <li><strong>School</strong> - Filter by specific school ID or name</li>
                      <li><strong>Class</strong> - Filter by classroom ID</li>
                      <li><strong>Student</strong> - Filter by student Core ID</li>
                      <li><strong>Grade</strong> - Filter by grade level (K1, K2, K3)</li>
                    </ul>
                  </li>
                  <li>Select specific value for your chosen filter type</li>
                  <li>Click <strong>"Start Checking"</strong> to apply filters and view results</li>
                </ol>

                <h4 class="text-lg font-semibold mb-3">Filter Rules and Hierarchy</h4>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4 rounded">
                  <p class="text-sm text-gray-700 mb-2"><strong>Important filtering behavior:</strong></p>
                  <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1">
                    <li><strong>District and Group are independent</strong> - You can use both simultaneously (e.g., "Group 1 schools in Shatin district")</li>
                    <li><strong>School/Class/Student are hierarchical</strong> - Once you select a lower level (e.g., School), higher incompatible levels become unavailable</li>
                    <li><strong>Multiple filters of same type</strong> - You can add multiple filters of the same type to create "OR" conditions</li>
                  </ul>
                </div>

                <h4 class="text-lg font-semibold mb-3">Removing Filters</h4>
                <ul class="list-disc ml-6 space-y-1 text-gray-700">
                  <li>Click the <strong>X</strong> button on any filter chip to remove individual filters</li>
                  <li>Click <strong>"Clear All"</strong> button to remove all filters at once</li>
                  <li>Filters persist until manually cleared or page is refreshed</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">School and Class Page Filters</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="text-gray-700 mb-4">In addition to homepage filters, <strong>School View</strong> and <strong>Class View</strong> pages have their own built-in filtering:</p>

                <h4 class="text-lg font-semibold mb-3">School View Filters</h4>
                <div class="space-y-3">
                  <div class="border-l-4 border-blue-500 pl-4">
                    <div class="font-semibold text-sm mb-1">1. Data Filter (Dropdown)</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ <strong>All:</strong> Show all classes/students</li>
                      <li>‚Ä¢ <strong>With Data Only:</strong> Show only those with submission data</li>
                      <li>‚Ä¢ <strong>Incomplete Only:</strong> Show only those with incomplete tasks</li>
                    </ul>
                  </div>

                  <div class="border-l-4 border-green-500 pl-4">
                    <div class="font-semibold text-sm mb-1">2. Grade Filter (Button ‚Üí Modal)</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ <strong>All Grades:</strong> Show all classes/students</li>
                      <li>‚Ä¢ <strong>K1:</strong> Show only K1 (23/24 academic year)</li>
                      <li>‚Ä¢ <strong>K2:</strong> Show only K2 (24/25 academic year)</li>
                      <li>‚Ä¢ <strong>K3:</strong> Show only K3 (25/26 academic year)</li>
                      <li>‚Ä¢ <strong>Others:</strong> Show grade 0 or unspecified</li>
                    </ul>
                  </div>

                  <div class="border-l-4 border-purple-500 pl-4">
                    <div class="font-semibold text-sm mb-1">3. View Mode Toggle</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ <strong>By Class:</strong> Show classes with Set 1-4 completion</li>
                      <li>‚Ä¢ <strong>By Student ‚Üí By Set:</strong> Student view with Set 1-4 status</li>
                      <li>‚Ä¢ <strong>By Student ‚Üí By Task:</strong> Student view with individual task completion</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">Filter Use Cases</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <div class="grid md:grid-cols-2 gap-4">
                  <div class="diagram-box bg-blue-50 border-blue-300">
                    <h4 class="font-semibold mb-2">Review incomplete K1 students in Shatin</h4>
                    <div class="text-sm text-gray-700">
                      <div class="mb-2"><strong>Homepage Filters:</strong></div>
                      <ul class="list-disc ml-6 space-y-1">
                        <li>District: Shatin</li>
                        <li>Grade: K1</li>
                      </ul>
                      <div class="mt-2 text-xs text-gray-600">Then navigate to School ‚Üí toggle "By Student" ‚Üí apply "Incomplete Only" filter</div>
                    </div>
                  </div>

                  <div class="diagram-box bg-green-50 border-green-300">
                    <h4 class="font-semibold mb-2">Check specific school's progress</h4>
                    <div class="text-sm text-gray-700">
                      <div class="mb-2"><strong>Homepage Filter:</strong></div>
                      <ul class="list-disc ml-6 space-y-1">
                        <li>School: S023</li>
                      </ul>
                      <div class="mt-2 text-xs text-gray-600">Click "Start Checking" ‚Üí View school summary ‚Üí Review by class or student</div>
                    </div>
                  </div>

                  <div class="diagram-box bg-purple-50 border-purple-300">
                    <h4 class="font-semibold mb-2">Monitor Group 1 completion rates</h4>
                    <div class="text-sm text-gray-700">
                      <div class="mb-2"><strong>Homepage Filter:</strong></div>
                      <ul class="list-disc ml-6 space-y-1">
                        <li>Group: 1</li>
                      </ul>
                      <div class="mt-2 text-xs text-gray-600">View all Group 1 schools ‚Üí Identify lagging schools ‚Üí Drill down</div>
                    </div>
                  </div>

                  <div class="diagram-box bg-amber-50 border-amber-300">
                    <h4 class="font-semibold mb-2">Combine filters for precision</h4>
                    <div class="text-sm text-gray-700">
                      <div class="mb-2"><strong>Example:</strong></div>
                      <div class="text-xs text-gray-600">Homepage ‚Üí "District: Shatin" ‚Üí School S023 ‚Üí "Incomplete Only" ‚Üí "Grade: K1"</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Data Export Section -->
          <section id="export" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">VII</span>
              Data Export
            </h2>

            <p class="text-gray-700 mb-6">
              Export functionality is available at multiple levels (District, Group, School, Class, Student) to generate reports for analysis and sharing.
            </p>

            <div class="grid md:grid-cols-3 gap-4">
              <div class="diagram-box bg-blue-50 border-blue-300">
                <h3 class="font-semibold mb-2">CSV Export</h3>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>‚úì Excel-compatible format</li>
                  <li>‚úì All visible columns</li>
                  <li>‚úì UTF-8 encoding (Chinese support)</li>
                  <li>‚úì Best for data analysis</li>
                </ul>
              </div>

              <div class="diagram-box bg-green-50 border-green-300">
                <h3 class="font-semibold mb-2">PDF Export</h3>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>‚úì Formatted tables</li>
                  <li>‚úì Charts and graphs</li>
                  <li>‚úì Summary statistics</li>
                  <li>‚úì Best for printing/presentations</li>
                </ul>
              </div>

              <div class="diagram-box bg-purple-50 border-purple-300">
                <h3 class="font-semibold mb-2">JSON Export</h3>
                <ul class="text-sm text-gray-700 space-y-1">
                  <li>‚úì Raw data structure</li>
                  <li>‚úì All metadata included</li>
                  <li>‚úì API-compatible format</li>
                  <li>‚úì Best for technical use</li>
                </ul>
              </div>
            </div>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mt-6">
              <p class="text-sm text-gray-700">
                <strong>üí° Tip:</strong> To export data, navigate to the desired level (e.g., School page), apply any filters, then click the "Export" button. Choose your preferred format and save the file.
              </p>
            </div>
          </section>

          <!-- Cache Management Section -->
          <section id="cache" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">VIII</span>
              Cache Management
            </h2>

            <p class="text-gray-700 mb-6">
              The Checking System uses <strong>IndexedDB</strong> (browser-based database) to cache assessment data locally for fast performance.
            </p>

            <h3 class="text-2xl font-semibold mb-4">Cache Status Indicator</h3>
            
            <p class="text-gray-700 mb-4">The cache status pill button appears at the top of the homepage and changes color based on the current state:</p>

            <!-- Visual Demo of Cache Status Pills -->
            <div class="bg-gray-50 p-6 rounded-lg border-2 border-gray-200 mb-6 cache-status-preview-container" style="position: relative;">
              <!-- "See More" button - shown on hover -->
              <button 
                class="cache-status-enlarge-btn" 
                onclick="openCacheStatusModal()"
                style="position: absolute; top: 12px; right: 12px; z-index: 50; background-color: rgba(43, 57, 144, 0.95); color: white; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.2s ease; cursor: pointer; border: none;"
                title="See More"
              >
                <span style="display: flex; align-items: center; gap: 6px;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M9 21H3v-6"/><path d="M21 3l-7 7"/><path d="M3 21l7-7"/></svg>
                  See More
                </span>
              </button>
              
              <h4 class="font-semibold mb-4 text-center">Visual Guide: Cache Status Pills</h4>
              
              <div class="space-y-4">
                <!-- Red Status -->
                <div class="flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border-l-4 border-red-500">
                  <div class="flex-shrink-0">
                    <div class="px-6 py-3 rounded-full bg-red-100 text-red-700 font-bold text-sm border-2 border-red-300 cursor-pointer hover:bg-red-200 transition">
                      üî¥ System Not Ready
                    </div>
                  </div>
                  <div class="flex-1">
                    <div class="font-semibold text-gray-800">No cache exists</div>
                    <div class="text-sm text-gray-600">Click to build cache and sync data from JotForm</div>
                    <div class="text-xs text-gray-500 mt-1">‚Üí Clicking opens a modal with "Sync Now" button</div>
                  </div>
                </div>

                <!-- Orange Status -->
                <div class="flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border-l-4 border-orange-500">
                  <div class="flex-shrink-0">
                    <div class="px-6 py-3 rounded-full bg-orange-100 text-orange-700 font-bold text-sm border-2 border-orange-300">
                      üü† Syncing 45%
                    </div>
                  </div>
                  <div class="flex-1">
                    <div class="font-semibold text-gray-800">Cache is being built</div>
                    <div class="text-sm text-gray-600">Shows real-time progress (0-100%)</div>
                    <div class="text-xs text-gray-500 mt-1">‚Üí Do not close the page during sync</div>
                  </div>
                </div>

                <!-- Green Status -->
                <div class="flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border-l-4 border-green-500">
                  <div class="flex-shrink-0">
                    <div class="px-6 py-3 rounded-full bg-green-100 text-green-700 font-bold text-sm border-2 border-green-300 cursor-pointer hover:bg-green-200 transition">
                      üü¢ System Ready
                    </div>
                  </div>
                  <div class="flex-1">
                    <div class="font-semibold text-gray-800">Cache is valid and ready</div>
                    <div class="text-sm text-gray-600">Data is cached and system is operational</div>
                    <div class="text-xs text-gray-500 mt-1">‚Üí Click to refresh cache or delete cache</div>
                  </div>
                </div>
              </div>
            </div>
            
            <style>
              .cache-status-preview-container:hover .cache-status-enlarge-btn {
                opacity: 1 !important;
              }
              .cache-status-enlarge-btn:hover {
                background-color: rgba(43, 57, 144, 1) !important;
                transform: translateY(-2px);
                box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
              }
            </style>

            <h3 class="text-2xl font-semibold mb-4 mt-8">How to Manage the Cache</h3>
            
            <!-- Cache Management Flowchart -->
            <div class="bg-gradient-to-br from-blue-50 to-purple-50 p-6 rounded-lg border-2 border-blue-200 mb-8">
              <h4 class="font-semibold mb-6 text-center text-lg">Cache Management Workflow</h4>
              
              <div class="mermaid">
flowchart TD
    Start([Open Checking System]) --> CheckCache{Is cache<br/>built?}
    
    CheckCache -->|NO - üî¥ Red Pill| ClickRed[Click Red Pill<br/>'System Not Ready']
    CheckCache -->|YES - üü¢ Green Pill| Ready[System Ready<br/>Browse Data]
    
    ClickRed --> OpenModal[Modal Opens]
    OpenModal --> SyncNow[Click 'Sync Now']
    SyncNow --> Syncing[üü† Syncing...<br/>Shows Progress %]
    Syncing --> SyncDone{Sync<br/>Complete?}
    
    SyncDone -->|YES| GreenPill[‚úÖ Pill turns GREEN<br/>System Ready]
    SyncDone -->|ERROR| ErrorState[‚ùå Check Console<br/>for Errors]
    
    ErrorState --> TryAgain[Refresh page<br/>Try again]
    TryAgain --> Start
    
    Ready --> NeedRefresh{Need fresh<br/>data?}
    NeedRefresh -->|NO| Continue[Continue browsing]
    NeedRefresh -->|YES| ClickGreen[Click Green Pill]
    
    ClickGreen --> ChooseOption{Choose<br/>Option}
    ChooseOption -->|Delete Cache| DeleteAll[Removes ALL:<br/>1. JotForm cache<br/>2. Validation cache<br/>3. Qualtrics cache]
    ChooseOption -->|Refresh Qualtrics| RefreshTGMD[Re-sync only<br/>TGMD data<br/>Keep JotForm cache]
    
    DeleteAll --> Syncing
    RefreshTGMD --> QuickSync[Quick refresh<br/>~20-30 seconds]
    
    QuickSync --> GreenPill
    GreenPill --> End([Ready to Use])
    Continue --> End
    
    style Start fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style End fill:#4CAF50,stroke:#2E7D32,color:#fff
    style CheckCache fill:#F3E5F5,stroke:#9C27B0,color:#4A148C
    style SyncDone fill:#FFF3E0,stroke:#FF9800,color:#E65100
    style NeedRefresh fill:#E8F5E9,stroke:#4CAF50,color:#1B5E20
    style ChooseOption fill:#E1F5FE,stroke:#0288D1,color:#01579B
    style ClickRed fill:#FFE0E0,stroke:#E57373,color:#C62828
    style Syncing fill:#FFE0B2,stroke:#FF9800,color:#E65100
    style GreenPill fill:#E0F7E0,stroke:#81C784,color:#2E7D32
    style ErrorState fill:#FFE0E0,stroke:#E57373,color:#C62828
              </div>
              
              <div class="mt-6 p-4 bg-white rounded border">
                <p class="text-sm font-semibold mb-2">Key Paths:</p>
                <ul class="text-xs text-gray-700 space-y-1 ml-4">
                  <li>‚Ä¢ <strong>First-time setup:</strong> Red Pill ‚Üí Sync Now ‚Üí Wait for green</li>
                  <li>‚Ä¢ <strong>Refresh data:</strong> Green Pill ‚Üí Delete Cache ‚Üí Re-sync</li>
                  <li>‚Ä¢ <strong>Quick TGMD update:</strong> Green Pill ‚Üí Refresh with Qualtrics</li>
                </ul>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h4 class="text-lg font-semibold">Building the Cache (First Time)</h4>
                <span class="text-xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li>Click the <strong>red "System Not Ready"</strong> pill on the home page</li>
                  <li>Click <strong>"Sync Now"</strong> in the modal</li>
                  <li>Wait for sync to complete (~60-90 seconds)
                    <ul class="list-disc ml-6 mt-1 space-y-1 text-sm">
                      <li>Progress: Fetching (0-50%), Merging Qualtrics (50-70%), Validating (70-100%)</li>
                    </ul>
                  </li>
                  <li>Pill turns <strong>green</strong> when ready</li>
                </ol>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h4 class="text-lg font-semibold">Refreshing the Cache</h4>
                <span class="text-xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="mb-3">To get the latest data from JotForm/Qualtrics:</p>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                  <li>Click the <strong>green "System Ready"</strong> pill</li>
                  <li>Choose one of two options:
                    <ul class="list-disc ml-6 mt-1 space-y-1">
                      <li><strong>"Delete Cache":</strong> Removes all cached data, requires full re-sync</li>
                      <li><strong>"Refresh with Qualtrics":</strong> Re-syncs TGMD data without rebuilding everything</li>
                    </ul>
                  </li>
                </ol>
              </div>
            </div>

            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-6">
              <p class="font-semibold text-gray-800 mb-2">Cache Expiration</p>
              <ul class="text-sm text-gray-700 space-y-1">
                <li>‚Ä¢ <strong>Submissions:</strong> Expires after <strong>1 hour</strong></li>
                <li>‚Ä¢ <strong>Validation:</strong> Rebuilds when submissions cache is newer</li>
                <li>‚Ä¢ <strong>Qualtrics:</strong> No automatic expiration (manual refresh only)</li>
              </ul>
            </div>
          </section>

          <!-- Troubleshooting Section -->
          <section id="troubleshooting" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">IX</span>
              Troubleshooting
            </h2>

            <div class="space-y-4">
              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-xl font-semibold">Display Issues: "No data loading"</h3>
                  <span class="text-2xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="mb-3"><strong>Symptoms:</strong></p>
                  <ul class="list-disc ml-6 space-y-1 text-gray-700 mb-4">
                    <li>Blank screens</li>
                    <li>"Loading..." message persists</li>
                    <li>Tables show no rows</li>
                  </ul>

                  <p class="mb-3"><strong>Possible Causes:</strong></p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700 mb-4">
                    <li>Network connection lost</li>
                    <li>Jotform API error</li>
                    <li>Invalid credentials</li>
                    <li>Cache expired</li>
                  </ol>

                  <p class="mb-3"><strong>Solutions:</strong></p>
                  <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                    <li>Check internet connection</li>
                    <li>Refresh page (Ctrl+R)</li>
                    <li>Delete cache (click green pill ‚Üí "Delete Cache") and reload</li>
                    <li>Re-enter system password</li>
                    <li>Check browser console (F12) for errors</li>
                  </ol>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-xl font-semibold">Data Quality Issues: "Termination rule mismatch"</h3>
                  <span class="text-2xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="mb-3"><strong>Symptoms:</strong></p>
                  <ul class="list-disc ml-6 space-y-1 text-gray-700 mb-4">
                    <li>Yellow ‚ö†Ô∏è status showing</li>
                    <li>Recorded ‚â† Calculated</li>
                    <li>"Review needed" message</li>
                  </ul>

                  <p class="mb-3"><strong>Investigation Steps:</strong></p>
                  <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-4">
                    <li>Expand task details</li>
                    <li>Count correct answers manually</li>
                    <li>Verify threshold (ERV: ‚â•5, CM: ‚â•4)</li>
                    <li>Check if questions marked correctly</li>
                    <li>Review PDF if available</li>
                  </ol>

                  <p class="mb-3"><strong>Possible Causes:</strong></p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700 mb-4">
                    <li>Administrator counting error</li>
                    <li>Ambiguous answer (marked wrong but should be correct)</li>
                    <li>System calculation error</li>
                    <li>Missing question data</li>
                  </ol>

                  <p class="mb-3"><strong>Resolution:</strong></p>
                  <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                    <li>Document the discrepancy</li>
                    <li>Review with administrator</li>
                    <li>Determine correct value</li>
                    <li>Follow data correction procedure</li>
                    <li>Report if system bug</li>
                  </ol>
                </div>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="collapsible-header">
                <h3 class="text-xl font-semibold">How to Check Console Errors and Report to Admin</h3>
                <span class="text-2xl">‚ñº</span>
              </div>
              <div class="collapsible-content">
                <p class="text-gray-700 mb-4">When you encounter unexpected behavior or errors, checking the browser console can help identify the root cause. Follow these steps:</p>

                <h4 class="text-lg font-semibold mb-3 mt-4">Step 1: Open Browser Developer Tools</h4>
                <p class="text-sm text-gray-700 mb-3"><em>Note: If you use assistive technologies or cannot use keyboard shortcuts, look for "Developer Tools" or "Inspect" options in your browser's menu.</em></p>
                <div class="space-y-2 mb-4">
                  <div class="border-l-4 border-blue-500 pl-4">
                    <div class="font-semibold text-sm">For Chrome/Edge:</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Press <code class="bg-gray-100 px-1 rounded">F12</code> on your keyboard, OR</li>
                      <li>‚Ä¢ Right-click anywhere ‚Üí Select "Inspect", OR</li>
                      <li>‚Ä¢ Click three-dot menu (‚ãÆ) ‚Üí More tools ‚Üí Developer tools</li>
                    </ul>
                  </div>
                  <div class="border-l-4 border-orange-500 pl-4">
                    <div class="font-semibold text-sm">For Firefox:</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Press <code class="bg-gray-100 px-1 rounded">F12</code> on your keyboard, OR</li>
                      <li>‚Ä¢ Right-click anywhere ‚Üí Select "Inspect Element", OR</li>
                      <li>‚Ä¢ Click hamburger menu (‚â°) ‚Üí More tools ‚Üí Web Developer Tools</li>
                    </ul>
                  </div>
                  <div class="border-l-4 border-purple-500 pl-4">
                    <div class="font-semibold text-sm">For Safari (Mac):</div>
                    <ul class="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Enable Developer menu: Safari ‚Üí Preferences ‚Üí Advanced ‚Üí Check "Show Develop menu"</li>
                      <li>‚Ä¢ Press <code class="bg-gray-100 px-1 rounded">Option + Command + C</code>, OR</li>
                      <li>‚Ä¢ Develop menu ‚Üí Show Web Inspector</li>
                    </ul>
                  </div>
                </div>

                <h4 class="text-lg font-semibold mb-3">Step 2: Navigate to the Console Tab</h4>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-4">
                  <li>In the Developer Tools panel (usually at bottom or right side of browser)</li>
                  <li>Look for tabs at the top: Elements, Console, Sources, Network, etc.</li>
                  <li>Click the <strong>"Console"</strong> tab</li>
                  <li>You should now see a log of messages, warnings, and errors</li>
                </ol>

                <div class="bg-gray-50 border rounded p-4 mb-4">
                  <p class="text-sm font-semibold mb-2">What you'll see:</p>
                  <ul class="text-xs text-gray-700 space-y-1">
                    <li>‚Ä¢ <span class="text-blue-600">‚ÑπÔ∏è Blue/Info messages:</span> General information, usually safe to ignore</li>
                    <li>‚Ä¢ <span class="text-yellow-600">‚ö†Ô∏è Yellow/Warning messages:</span> Non-critical warnings, worth noting</li>
                    <li>‚Ä¢ <span class="text-red-600">‚ùå Red/Error messages:</span> Critical errors that break functionality - <strong>THESE are what to report</strong></li>
                  </ul>
                </div>

                <h4 class="text-lg font-semibold mb-3">Step 3: Reproduce the Issue</h4>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-4">
                  <li><strong>Clear the console first:</strong> Click the "Clear console" button (üö´ icon) or press <code class="bg-gray-100 px-1 rounded">Ctrl+L</code></li>
                  <li><strong>Perform the action that causes the error:</strong> Click the button, navigate to the page, apply the filter, etc.</li>
                  <li><strong>Watch for new red error messages</strong> to appear in the console</li>
                </ol>

                <h4 class="text-lg font-semibold mb-3">Step 4: Identify Relevant Errors</h4>
                <p class="text-sm text-gray-700 mb-2">Look for error messages that contain:</p>
                <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1 mb-4">
                  <li><strong>"Uncaught"</strong> - JavaScript errors</li>
                  <li><strong>"Failed to fetch"</strong> - Network/API errors</li>
                  <li><strong>"TypeError"</strong> - Data structure errors</li>
                  <li><strong>"ReferenceError"</strong> - Missing variables/functions</li>
                  <li><strong>Stack traces</strong> - Lines of code showing where error occurred</li>
                </ul>

                <h4 class="text-lg font-semibold mb-3">Step 5: Take Screenshots and Copy Error Details</h4>
                <ol class="list-decimal ml-6 space-y-2 text-gray-700 mb-4">
                  <li>Expand the error message (if collapsed) by clicking the triangle (‚ñ∂)</li>
                  <li>Take a screenshot of the error message and stack trace</li>
                  <li>Right-click on the error message ‚Üí "Copy message" or "Copy stack trace"</li>
                  <li>Paste into a text file or email</li>
                </ol>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded mb-4">
                  <p class="text-sm font-semibold mb-2">Screenshot shortcuts:</p>
                  <ul class="text-xs text-gray-700 space-y-1">
                    <li>‚Ä¢ <strong>Windows:</strong> Press <code class="bg-gray-100 px-1 rounded">Windows + Shift + S</code> (Windows 10 v1703+ or Windows 11) ‚Üí select area ‚Üí paste in email
                      <br/><span class="text-xs text-gray-500 ml-4">Older Windows: Use Snipping Tool from Start menu</span>
                    </li>
                    <li>‚Ä¢ <strong>Mac:</strong> Press <code class="bg-gray-100 px-1 rounded">Command + Shift + 4</code> ‚Üí drag to select ‚Üí file saves to desktop</li>
                  </ul>
                </div>

                <h4 class="text-lg font-semibold mb-3">Step 6: Report to Administrator</h4>
                <div class="bg-blue-50 border rounded p-4">
                  <p class="text-sm font-semibold mb-2">Include in your report:</p>
                  <ol class="text-xs text-gray-700 space-y-1 ml-4">
                    <li>1. <strong>What you were doing:</strong> Specific action that triggered the error</li>
                    <li>2. <strong>When it happened:</strong> Date and time</li>
                    <li>3. <strong>Browser information:</strong> Browser name and version (find in Help ‚Üí About Chrome/Firefox/Edge)</li>
                    <li>4. <strong>Console errors:</strong> Copied error messages and screenshots</li>
                    <li>5. <strong>System state:</strong> Was cache recently synced? Any other errors on page?</li>
                    <li>6. <strong>Reproducibility:</strong> Does it happen every time or randomly?</li>
                  </ol>
                </div>

                <h4 class="text-lg font-semibold mb-3 mt-4">Common Error Messages</h4>
                <table class="w-full text-sm border-collapse">
                  <thead>
                    <tr class="bg-gray-100">
                      <th class="border border-gray-300 px-3 py-2 text-left">Error Message</th>
                      <th class="border border-gray-300 px-3 py-2 text-left">Likely Cause</th>
                      <th class="border border-gray-300 px-3 py-2 text-left">Quick Fix</th>
                    </tr>
                  </thead>
                  <tbody class="text-xs">
                    <tr>
                      <td class="border border-gray-300 px-3 py-2">"Failed to fetch"</td>
                      <td class="border border-gray-300 px-3 py-2">Network issue or API down</td>
                      <td class="border border-gray-300 px-3 py-2">Check internet, try again in 5 min</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-300 px-3 py-2">"QuotaExceededError"</td>
                      <td class="border border-gray-300 px-3 py-2">Browser storage full</td>
                      <td class="border border-gray-300 px-3 py-2">Clear cache, close other tabs</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-300 px-3 py-2">"401 Unauthorized"</td>
                      <td class="border border-gray-300 px-3 py-2">Invalid credentials</td>
                      <td class="border border-gray-300 px-3 py-2">Re-enter system password</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-300 px-3 py-2">"Cannot read property..."</td>
                      <td class="border border-gray-300 px-3 py-2">Data missing or malformed</td>
                      <td class="border border-gray-300 px-3 py-2">Refresh page, report if persists</td>
                    </tr>
                  </tbody>
                </table>

                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded mt-4">
                  <p class="text-sm font-semibold mb-2">Privacy Note:</p>
                  <p class="text-xs text-gray-700 mb-2">When taking screenshots and sharing console logs, protect sensitive information:</p>
                  <ul class="text-xs text-gray-700 space-y-1 ml-4">
                    <li>‚Ä¢ Blur or crop any visible student names, IDs, or personal data</li>
                    <li>‚Ä¢ Never share system passwords or API keys</li>
                    <li>‚Ä¢ Avoid sharing session tokens or authentication credentials from logs</li>
                    <li>‚Ä¢ If error logs contain student IDs or personal data, redact them before sharing</li>
                    <li>‚Ä¢ When in doubt, ask before sharing any sensitive information</li>
                  </ul>
                </div>
              </div>
            </div>
          </section>

          <!-- FAQs Section -->
          <section id="faqs" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">X</span>
              Frequently Asked Questions
            </h2>

            <div class="space-y-4">
              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">How often does data update?</h3>
                  <span class="text-xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">The system uses a cache-based architecture:</p>
                  <ul class="list-disc ml-6 space-y-1 text-gray-700 mt-2">
                    <li><strong>Cache duration:</strong> 1 hour by default</li>
                    <li><strong>Manual refresh:</strong> Click green "System Ready" pill ‚Üí "Delete Cache" ‚Üí Re-sync</li>
                    <li><strong>Qualtrics refresh:</strong> Click green pill ‚Üí "Refresh with Qualtrics" (faster, keeps JotForm cache)</li>
                    <li><strong>Auto-expiration:</strong> Cache automatically expires after 1 hour</li>
                  </ul>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Can I edit data in the Checking System?</h3>
                  <span class="text-xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700">No. The Checking System is <strong>read-only</strong>. Data correction must be done in Jotform or by re-processing PDFs.</p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">What browsers are supported?</h3>
                  <span class="text-xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <ul class="list-disc ml-6 space-y-1 text-gray-700">
                    <li><strong>Fully supported:</strong> Chrome 90+, Edge 90+, Firefox 88+</li>
                    <li><strong>Limited support:</strong> Safari 14+</li>
                    <li><strong>Mobile:</strong> iOS Safari 14+, Chrome Android 90+</li>
                  </ul>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">Why do termination rules sometimes mismatch?</h3>
                  <span class="text-xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700 mb-2">Common reasons:</p>
                  <ol class="list-decimal ml-6 space-y-1 text-gray-700">
                    <li>Counting errors by administrator</li>
                    <li>Ambiguous answers (marked wrong but debatable)</li>
                    <li>Missing data (questions skipped)</li>
                    <li>System calculation logic difference</li>
                  </ol>
                  <p class="text-gray-700 mt-3"><strong>Always manually verify when mismatch detected.</strong></p>
                </div>
              </div>

              <div class="collapsible-section">
                <div class="collapsible-header">
                  <h3 class="text-lg font-semibold">How secure is the Checking System? What about data privacy?</h3>
                  <span class="text-xl">‚ñº</span>
                </div>
                <div class="collapsible-content">
                  <p class="text-gray-700 mb-3">The Checking System is designed with multiple layers of security and privacy protection:</p>
                  
                  <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">üîí Data Encryption & Transmission</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>HTTPS encryption:</strong> All API calls to JotForm and Qualtrics use encrypted connections</li>
                      <li><strong>Encrypted credentials:</strong> System password and API keys are encrypted at rest in <code class="bg-gray-200 px-1 rounded">assets/credentials.enc</code></li>
                      <li><strong>No plaintext passwords:</strong> Credentials never stored in browser history or logs</li>
                      <li><strong>Secure key derivation:</strong> Uses PBKDF2 with salt for password-based encryption</li>
                    </ul>
                  </div>

                  <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">üîê Access Control</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Password required:</strong> System password needed to decrypt credentials and access data</li>
                      <li><strong>Session timeout:</strong> Automatically locks after 30 minutes of inactivity</li>
                      <li><strong>No persistent login:</strong> Password must be re-entered after browser close</li>
                      <li><strong>Limited access:</strong> Only authorized project personnel should have the password</li>
                    </ul>
                  </div>

                  <div class="bg-purple-50 border-l-4 border-purple-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">üíæ Data Storage & Privacy</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Local-only cache:</strong> Data cached in browser's IndexedDB, never sent to external servers</li>
                      <li><strong>No cloud storage:</strong> System runs entirely client-side (in your browser)</li>
                      <li><strong>No third-party tracking:</strong> No analytics, no cookies, no external tracking scripts</li>
                      <li><strong>Data isolation:</strong> Each browser has its own isolated cache (no cross-browser sharing)</li>
                      <li><strong>Automatic cleanup:</strong> Cache expires after 1 hour or can be manually cleared</li>
                    </ul>
                  </div>

                  <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">üõ°Ô∏è Student Data Protection</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Read-only access:</strong> System cannot modify or delete student data</li>
                      <li><strong>No data export to cloud:</strong> Exports saved locally to your computer only</li>
                      <li><strong>Anonymized IDs:</strong> Students identified by Core IDs (e.g., C10207), not personal names in most views</li>
                      <li><strong>Secure source:</strong> All data fetched directly from JotForm's secure API</li>
                      <li><strong>Audit trail:</strong> Console logs can track who accessed what data (if enabled)</li>
                    </ul>
                  </div>

                  <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    <h4 class="font-semibold mb-2 text-gray-800">‚ö†Ô∏è Security Best Practices</h4>
                    <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
                      <li><strong>Don't share the password:</strong> Limit access to authorized personnel only</li>
                      <li><strong>Use trusted devices:</strong> Don't access from public or shared computers</li>
                      <li><strong>Clear cache when done:</strong> Especially on shared devices, delete cache before closing</li>
                      <li><strong>Lock your screen:</strong> Always lock your computer when stepping away</li>
                      <li><strong>Use updated browsers:</strong> Keep browser up-to-date for latest security patches</li>
                      <li><strong>Report security concerns:</strong> Contact project administrators immediately if you notice suspicious activity</li>
                    </ul>
                  </div>

                  <p class="text-sm text-gray-600 mt-4 italic">
                    <strong>Note:</strong> While the system implements strong security measures, ultimate data security also depends on user practices. Always follow institutional data protection policies and guidelines when handling student assessment data.
                  </p>
                </div>
              </div>
            </div>
          </section>

          <!-- Best Practices Section -->
          <section id="best-practices" class="content-section mb-12">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">
              <span class="step-number">XI</span>
              Best Practices
            </h2>

            <div class="grid md:grid-cols-2 gap-6">
              <div class="diagram-box bg-blue-50 border-blue-300">
                <h3 class="text-lg font-semibold mb-3">üìÖ Daily Monitoring</h3>
                <ul class="space-y-2 text-gray-700 text-sm">
                  <li>‚úì Start of day routine (15 min)
                    <ul class="list-disc ml-6 mt-1 space-y-1">
                      <li>Open Checking System</li>
                      <li>Refresh cache</li>
                      <li>Review yesterday's submissions</li>
                    </ul>
                  </li>
                  <li>‚úì Random sampling (5 students daily)</li>
                  <li>‚úì Issue tracking and logging</li>
                </ul>
              </div>

              <div class="diagram-box bg-green-50 border-green-300">
                <h3 class="text-lg font-semibold mb-3">üìä Weekly Review</h3>
                <ul class="space-y-2 text-gray-700 text-sm">
                  <li>‚úì Generate weekly summary report</li>
                  <li>‚úì Quality audit (10-15 students)</li>
                  <li>‚úì Follow up with schools &lt; 50% completion</li>
                  <li>‚úì Compare to previous week</li>
                </ul>
              </div>

              <div class="diagram-box bg-purple-50 border-purple-300">
                <h3 class="text-lg font-semibold mb-3">‚úÖ Data Quality</h3>
                <ul class="space-y-2 text-gray-700 text-sm">
                  <li>‚úì Always check termination mismatches</li>
                  <li>‚úì Manually verify ambiguous cases</li>
                  <li>‚úì Document all discrepancies</li>
                  <li>‚úì Look for patterns in errors</li>
                </ul>
              </div>

              <div class="diagram-box bg-yellow-50 border-yellow-300">
                <h3 class="text-lg font-semibold mb-3">üí¨ Communication</h3>
                <ul class="space-y-2 text-gray-700 text-sm">
                  <li>‚úì Provide clear, specific feedback</li>
                  <li>‚úì Include screenshots when reporting</li>
                  <li>‚úì Use visual reports for management</li>
                  <li>‚úì Document technical issues thoroughly</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Quick Reference Section -->
          <section class="content-section mb-8">
            <h2 class="text-3xl font-bold mb-6" style="color: var(--primary)">Quick Reference</h2>

            <div class="grid md:grid-cols-2 gap-6">
              <div class="diagram-box">
                <h3 class="text-lg font-semibold mb-3">Status Indicators</h3>
                <div class="space-y-2 text-sm">
                  <div><span class="status-badge status-complete">‚úÖ Green</span> = Complete & Verified</div>
                  <div><span class="status-badge status-warning">‚ö†Ô∏è Yellow</span> = Needs Review (Mismatch)</div>
                  <div><span class="status-badge status-error">üî¥ Red</span> = Incomplete (Missing Data)</div>
                  <div><span class="status-badge bg-gray-200 text-gray-700">‚≠ï Grey</span> = Not Started</div>
                </div>
              </div>

              <div class="diagram-box">
                <h3 class="text-lg font-semibold mb-3">Keyboard Shortcuts</h3>
                <div class="space-y-2 text-sm">
                  <div><code>Ctrl+R</code> - Refresh page</div>
                  <div><code>Ctrl+Shift+R</code> - Hard refresh (clear cache)</div>
                  <div><code>Ctrl+F</code> - Search on page</div>
                  <div><code>F12</code> - Open developer console</div>
                  <div><code>Esc</code> - Close modals</div>
                </div>
              </div>
            </div>
          </section>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-600 text-sm py-8">
          <p><strong>4Set System</strong> - KeySteps@JC (Phase Two)</p>
          <p class="mt-2">The Education University of Hong Kong | Version 1.0 | October 2025</p>
          <p class="mt-4">For questions, feedback, or support, please contact the project team or refer to the technical documentation in the PRDs folder.</p>
        </footer>
      </main>
    </div>
  </div>

  <!-- JavaScript for collapsible sections and navigation -->
  <script src="assets/js/user-guides.js"></script>
  <script src="assets/js/spotlight-system.js"></script>
  <script src="assets/js/tooltip-positioner.js"></script>
  
  <!-- Filter Configuration Panel Modal -->
  <div id="filterPanelModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-[9999]" style="display: none;">
    <div id="filterModalOverlay" class="absolute inset-0"></div>
    <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full mx-4 relative z-[10002]" style="max-height: 90vh; overflow-y: auto;">
      <!-- Modal Header -->
      <div class="sticky top-0 bg-gradient-to-r from-primary to-indigo-600 text-white px-8 py-6 rounded-t-2xl z-10">
        <div class="flex items-center justify-between">
          <h2 class="text-2xl font-bold">Filter Configuration Panel</h2>
          <button 
            onclick="closeFilterPanelModal()" 
            data-spotlight="close"
            class="text-white hover:bg-white/20 rounded-full p-2 transition-all hover:rotate-90"
            title="Close"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <p class="text-sm opacity-90 mt-2">Hover over filter elements to see explanations</p>
      </div>
      
      <!-- Modal Body -->
      <div class="p-8">
        <!-- Simulated Filter Panel Interface -->
        <div class="border-2 border-gray-300 rounded-lg p-8 bg-gradient-to-br from-blue-50 to-gray-50 mb-6">
          <div class="space-y-6">
            <h3 class="text-xl font-semibold text-gray-800 text-center mb-6">Configure Filters</h3>
            
            <!-- Active Filters Chips -->
            <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200">
              <p class="text-sm font-semibold text-gray-700 mb-3">Active Filters (2)</p>
              <div class="flex flex-wrap gap-3">
                <div 
                  class="filter-chip px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold border-2 border-blue-300 cursor-pointer hover:shadow-lg transition-all relative"
                  data-spotlight="button"
                  data-tooltip-title="Filter Chip: District"
                  data-tooltip-description="Shows active filter. Click the √ó button to remove this filter. Each chip represents one filter criterion applied to your data."
                >
                  District: Shatin
                  <button class="ml-2 hover:text-blue-900 font-bold">√ó</button>
                </div>
                <div 
                  class="filter-chip px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-semibold border-2 border-green-300 cursor-pointer hover:shadow-lg transition-all relative"
                  data-spotlight="button"
                  data-tooltip-title="Filter Chip: Grade"
                  data-tooltip-description="Another active filter. You can combine multiple filters to narrow down results. Click √ó to remove."
                >
                  Grade: K1
                  <button class="ml-2 hover:text-green-900 font-bold">√ó</button>
                </div>
              </div>
              <div class="mt-3 flex gap-3">
                <button 
                  class="px-3 py-1 bg-red-100 text-red-700 rounded text-xs font-semibold hover:bg-red-200 transition relative"
                  data-spotlight="button"
                  data-tooltip-title="Clear All Button"
                  data-tooltip-description="Removes all active filters at once. Useful when you want to start fresh with a new filter configuration."
                >
                  Clear All
                </button>
              </div>
            </div>
            
            <!-- Add Filter Controls -->
            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
              <div class="flex gap-4 items-center flex-wrap">
                <select 
                  class="filter-type-select px-4 py-2 border-2 border-gray-300 rounded-lg text-sm font-semibold cursor-pointer hover:border-primary transition-all relative"
                  data-spotlight="button"
                  data-tooltip-title="Filter Type Selector"
                  data-tooltip-description="Choose which type of filter to add: District, Group, School, Class, Student, or Grade. Different types allow filtering by different organizational levels."
                >
                  <option>Select filter type...</option>
                  <option>District</option>
                  <option>Group</option>
                  <option>School</option>
                  <option>Class</option>
                  <option>Student</option>
                  <option>Grade</option>
                </select>
                
                <select 
                  class="filter-value-select px-4 py-2 border-2 border-gray-300 rounded-lg text-sm font-semibold cursor-pointer hover:border-primary transition-all relative"
                  data-spotlight="button"
                  data-tooltip-title="Filter Value Selector"
                  data-tooltip-description="After selecting a filter type, choose the specific value here. For example, if you chose 'District', you can select 'Shatin', 'Tuen Mun', etc."
                >
                  <option>Select value...</option>
                  <option>Shatin</option>
                  <option>Sham Shui Po</option>
                  <option>Kowloon City</option>
                </select>
                
                <button 
                  class="add-filter-btn px-6 py-2 bg-primary text-white rounded-lg text-sm font-semibold hover:bg-primary/90 transition-all shadow-md hover:shadow-lg relative"
                  data-spotlight="button"
                  data-tooltip-title="Add Filter Button"
                  data-tooltip-description="Click to add the configured filter to your active filters list. The new filter chip will appear above."
                >
                  + Add Filter
                </button>
              </div>
            </div>
            
            <!-- Start Checking Button -->
            <div class="text-center pt-4">
              <button 
                class="start-checking-btn px-8 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl text-base font-bold hover:shadow-xl transition-all relative"
                data-spotlight="button"
                data-tooltip-title="Start Checking Button"
                data-tooltip-description="After configuring your filters, click this button to apply them and view the filtered data. Results will show only records matching ALL active filters."
              >
                üöÄ Start Checking
              </button>
            </div>
            
            <!-- Help Icon -->
            <div class="flex justify-center mt-4">
              <button 
                class="help-icon p-3 rounded-full bg-gray-100 hover:bg-gray-200 transition-all relative"
                data-spotlight="help"
                data-tooltip-title="Help Icon"
                data-tooltip-description="Click for filtering tips, examples, and troubleshooting"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Instructions -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded">
          <h4 class="font-semibold text-blue-900 mb-3">üí° Quick Filtering Tips</h4>
          <ul class="list-disc ml-6 space-y-2 text-sm text-gray-700">
            <li><strong>Multiple Filters:</strong> Add multiple filters to create complex queries (e.g., "K1 students in Shatin district")</li>
            <li><strong>Filter Hierarchy:</strong> District and Group filters are independent; School/Class/Student are hierarchical</li>
            <li><strong>Remove Filters:</strong> Click √ó on any filter chip to remove it, or use "Clear All" to start fresh</li>
            <li><strong>Apply Filters:</strong> Click "Start Checking" to view filtered results</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Guide-specific customizations can go here
    document.addEventListener('DOMContentLoaded', () => {
      // Update arrow elements after collapsibles initialize
      setTimeout(() => {
        document.querySelectorAll('.collapsible-header span:last-child').forEach(arrow => {
          const content = arrow.closest('.collapsible-header').nextElementSibling;
          arrow.textContent = content.classList.contains('active') ? '‚ñ≤' : '‚ñº';
          arrow.classList.add('arrow');
        });
      }, 100);
    });
    
    // Filter Panel Modal Functions
    let filterPanelSpotlight = null;
    let filterPanelTooltipPositioner = null;
    
    function openFilterPanelModal() {
      const modal = document.getElementById('filterPanelModal');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      
      // Initialize spotlight system
      setTimeout(() => {
        filterPanelSpotlight = new SpotlightSystem({
          overlaySelector: '#filterModalOverlay',
          targets: '[data-spotlight="button"], [data-spotlight="help"]',
          closeButton: '[data-spotlight="close"]',
          modalSelector: '#filterPanelModal',
          padding: 14,
          dimOpacity: 0.55
        });
        filterPanelSpotlight.enable();
        
        // Initialize tooltip positioner
        filterPanelTooltipPositioner = new TooltipPositioner({
          tooltipSelector: '.feature-tooltip',
          padding: 10
        });
        
        // Add hover listeners for tooltips
        const spotlightElements = document.querySelectorAll('#filterPanelModal [data-spotlight="button"], #filterPanelModal [data-spotlight="help"]');
        spotlightElements.forEach(el => {
          el.addEventListener('mouseenter', function() {
            showFilterPanelTooltip(this);
          });
          el.addEventListener('mouseleave', function() {
            hideFilterPanelTooltip(this);
          });
        });
      }, 100);
    }
    
    function closeFilterPanelModal() {
      const modal = document.getElementById('filterPanelModal');
      modal.style.display = 'none';
      document.body.style.overflow = '';
      
      // Cleanup spotlight
      if (filterPanelSpotlight) {
        filterPanelSpotlight.disable();
        filterPanelSpotlight = null;
      }
      
      // Remove all tooltips
      document.querySelectorAll('.feature-tooltip').forEach(tooltip => tooltip.remove());
    }
    
    function showFilterPanelTooltip(element) {
      const title = element.getAttribute('data-tooltip-title');
      const description = element.getAttribute('data-tooltip-description');
      
      if (!title || !description) return;
      
      // Create tooltip
      const tooltip = document.createElement('div');
      tooltip.className = 'feature-tooltip';
      tooltip.id = `tooltip-${Math.random().toString(36).substr(2, 9)}`;
      tooltip.innerHTML = `
        <div>${title}</div>
        <div>${description}</div>
      `;
      tooltip.style.display = 'none';
      
      document.body.appendChild(tooltip);
      
      // Position tooltip
      if (filterPanelTooltipPositioner) {
        filterPanelTooltipPositioner.positionTooltip(tooltip, element);
      }
      
      // Show tooltip with fade-in
      setTimeout(() => {
        tooltip.style.display = 'block';
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';
      }, 50);
      
      // Store tooltip reference
      element._activeTooltip = tooltip;
    }
    
    function hideFilterPanelTooltip(element) {
      if (element._activeTooltip) {
        element._activeTooltip.remove();
        element._activeTooltip = null;
      }
    }
    
    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && document.getElementById('filterPanelModal').style.display === 'flex') {
        closeFilterPanelModal();
      }
    });
    
    // Close modal on overlay click
    document.getElementById('filterModalOverlay')?.addEventListener('click', closeFilterPanelModal);
    
    // ========== Cache Status Modal Functions ==========
    let cacheStatusSpotlight = null;
    let cacheStatusTooltipPositioner = null;
    
    function openCacheStatusModal() {
      // First, create the modal if it doesn't exist
      if (!document.getElementById('cacheStatusModal')) {
        const modalHTML = `
          <div id="cacheStatusModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-[9999]" style="display: none;">
            <div id="cacheModalOverlay" class="absolute inset-0"></div>
            <div class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full mx-4 relative z-[10002]" style="max-height: 90vh; overflow-y: auto;">
              <!-- Modal Header -->
              <div class="sticky top-0 bg-gradient-to-r from-primary to-indigo-600 text-white px-8 py-6 rounded-t-2xl z-10">
                <div class="flex items-center justify-between">
                  <h2 class="text-2xl font-bold">Cache Status & Management</h2>
                  <button 
                    onclick="closeCacheStatusModal()" 
                    data-spotlight="close"
                    class="text-white hover:bg-white/20 rounded-full p-2 transition-all hover:rotate-90"
                    title="Close"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
                <p class="text-sm opacity-90 mt-2">Click on status pills to see different cache management actions</p>
              </div>
              
              <!-- Modal Body -->
              <div class="p-8">
                <!-- Simulated Cache Status Pills -->
                <div class="border-2 border-gray-300 rounded-lg p-8 bg-gradient-to-br from-purple-50 to-gray-50 mb-6">
                  <div class="space-y-8">
                    <h3 class="text-xl font-semibold text-gray-800 text-center mb-6">Cache Status Pills</h3>
                    
                    <!-- Red Status Pill -->
                    <div class="flex items-center gap-6 p-6 bg-white rounded-lg shadow-lg border-l-4 border-red-500">
                      <div class="flex-shrink-0">
                        <button 
                          class="cache-pill-red px-8 py-4 rounded-full bg-red-100 text-red-700 font-bold text-lg border-3 border-red-300 cursor-pointer hover:shadow-xl transition-all relative"
                          data-spotlight="button"
                          data-tooltip-title="Red Pill: System Not Ready"
                          data-tooltip-description="Click this pill to build the cache for the first time. Opens a modal with 'Sync Now' button to fetch data from JotForm."
                        >
                          üî¥ System Not Ready
                        </button>
                      </div>
                      <div class="flex-1">
                        <div class="font-semibold text-gray-800 mb-1">No cache exists</div>
                        <div class="text-sm text-gray-600">Click to build cache and sync data from JotForm</div>
                      </div>
                    </div>
                    
                    <!-- Orange Status Pill -->
                    <div class="flex items-center gap-6 p-6 bg-white rounded-lg shadow-lg border-l-4 border-orange-500">
                      <div class="flex-shrink-0">
                        <div 
                          class="cache-pill-orange px-8 py-4 rounded-full bg-orange-100 text-orange-700 font-bold text-lg border-3 border-orange-300 relative"
                          data-spotlight="button"
                          data-tooltip-title="Orange Pill: Syncing"
                          data-tooltip-description="Shows real-time sync progress. The percentage updates as data is fetched from JotForm. Do not close the page during sync."
                        >
                          üü† Syncing 45%
                        </div>
                      </div>
                      <div class="flex-1">
                        <div class="font-semibold text-gray-800 mb-1">Cache is being built</div>
                        <div class="text-sm text-gray-600">Shows real-time progress (0-100%)</div>
                      </div>
                    </div>
                    
                    <!-- Green Status Pill -->
                    <div class="flex items-center gap-6 p-6 bg-white rounded-lg shadow-lg border-l-4 border-green-500">
                      <div class="flex-shrink-0">
                        <button 
                          class="cache-pill-green px-8 py-4 rounded-full bg-green-100 text-green-700 font-bold text-lg border-3 border-green-300 cursor-pointer hover:shadow-xl transition-all relative"
                          data-spotlight="button"
                          data-tooltip-title="Green Pill: System Ready"
                          data-tooltip-description="Cache is built and ready. Click to access cache management options: Delete Cache (full re-sync) or Refresh with Qualtrics (quick TGMD update)."
                        >
                          üü¢ System Ready
                        </button>
                      </div>
                      <div class="flex-1">
                        <div class="font-semibold text-gray-800 mb-1">Cache is valid and ready</div>
                        <div class="text-sm text-gray-600">Click to refresh cache or delete cache</div>
                      </div>
                    </div>
                    
                    <!-- Help Icon -->
                    <div class="flex justify-center mt-8">
                      <button 
                        class="help-icon p-4 rounded-full bg-gray-100 hover:bg-gray-200 transition-all relative"
                        data-spotlight="help"
                        data-tooltip-title="Help Icon"
                        data-tooltip-description="Click for cache management help, troubleshooting tips, and expiration policy"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <circle cx="12" cy="12" r="10"></circle>
                          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                          <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
                
                <!-- Instructions -->
                <div class="bg-purple-50 border-l-4 border-purple-500 p-6 rounded">
                  <h4 class="font-semibold text-purple-900 mb-3">üí° Cache Management Tips</h4>
                  <ul class="list-disc ml-6 space-y-2 text-sm text-gray-700">
                    <li><strong>First-time setup:</strong> Click red pill ‚Üí Sync Now ‚Üí Wait for green (60-90 seconds)</li>
                    <li><strong>Refresh data:</strong> Click green pill ‚Üí Delete Cache ‚Üí Re-sync for latest data</li>
                    <li><strong>Quick TGMD update:</strong> Click green pill ‚Üí Refresh with Qualtrics (20-30 seconds)</li>
                    <li><strong>Cache expiration:</strong> Submissions cache expires after 1 hour automatically</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        
        // Add close handler for overlay
        document.getElementById('cacheModalOverlay')?.addEventListener('click', closeCacheStatusModal);
      }
      
      const modal = document.getElementById('cacheStatusModal');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      
      // Initialize spotlight system
      setTimeout(() => {
        cacheStatusSpotlight = new SpotlightSystem({
          overlaySelector: '#cacheModalOverlay',
          targets: '[data-spotlight="button"], [data-spotlight="help"]',
          closeButton: '[data-spotlight="close"]',
          modalSelector: '#cacheStatusModal',
          padding: 14,
          dimOpacity: 0.55
        });
        cacheStatusSpotlight.enable();
        
        // Initialize tooltip positioner
        cacheStatusTooltipPositioner = new TooltipPositioner({
          tooltipSelector: '.feature-tooltip',
          padding: 10
        });
        
        // Add hover listeners for tooltips
        const spotlightElements = document.querySelectorAll('#cacheStatusModal [data-spotlight="button"], #cacheStatusModal [data-spotlight="help"]');
        spotlightElements.forEach(el => {
          el.addEventListener('mouseenter', function() {
            showCacheStatusTooltip(this);
          });
          el.addEventListener('mouseleave', function() {
            hideCacheStatusTooltip(this);
          });
        });
      }, 100);
    }
    
    function closeCacheStatusModal() {
      const modal = document.getElementById('cacheStatusModal');
      if (!modal) return;
      
      modal.style.display = 'none';
      document.body.style.overflow = '';
      
      // Cleanup spotlight
      if (cacheStatusSpotlight) {
        cacheStatusSpotlight.disable();
        cacheStatusSpotlight = null;
      }
      
      // Remove all tooltips
      document.querySelectorAll('.feature-tooltip').forEach(tooltip => tooltip.remove());
    }
    
    function showCacheStatusTooltip(element) {
      const title = element.getAttribute('data-tooltip-title');
      const description = element.getAttribute('data-tooltip-description');
      
      if (!title || !description) return;
      
      // Create tooltip
      const tooltip = document.createElement('div');
      tooltip.className = 'feature-tooltip';
      tooltip.id = `tooltip-${Math.random().toString(36).substr(2, 9)}`;
      tooltip.innerHTML = `
        <div>${title}</div>
        <div>${description}</div>
      `;
      tooltip.style.display = 'none';
      
      document.body.appendChild(tooltip);
      
      // Position tooltip
      if (cacheStatusTooltipPositioner) {
        cacheStatusTooltipPositioner.positionTooltip(tooltip, element);
      }
      
      // Show tooltip with fade-in
      setTimeout(() => {
        tooltip.style.display = 'block';
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';
      }, 50);
      
      // Store tooltip reference
      element._activeTooltip = tooltip;
    }
    
    function hideCacheStatusTooltip(element) {
      if (element._activeTooltip) {
        element._activeTooltip.remove();
        element._activeTooltip = null;
      }
    }
    
    // Handle escape key for cache status modal
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && document.getElementById('cacheStatusModal')?.style.display === 'flex') {
        closeCacheStatusModal();
      }
      if (e.key === 'Escape' && document.getElementById('homepageLayoutModal')?.style.display === 'flex') {
        closeHomepageLayoutModal();
      }
    });
    
    // Homepage Layout Modal Functions
    function openHomepageLayoutModal() {
      const modal = document.getElementById('homepageLayoutModal');
      if (!modal) return;
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }
    
    function closeHomepageLayoutModal() {
      const modal = document.getElementById('homepageLayoutModal');
      if (!modal) return;
      modal.style.display = 'none';
      document.body.style.overflow = '';
    }
    
    document.getElementById('homepageLayoutModal')?.addEventListener('click', function(e) {
      if (e.target === this) closeHomepageLayoutModal();
    });
  </script>
  
  <!-- Homepage Layout Modal - 1:1 Replica of Checking System Homepage -->
  <div id="homepageLayoutModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-[9999]" style="display: none;">
    <div class="bg-white rounded-2xl shadow-2xl max-w-7xl w-full mx-4 relative overflow-hidden" style="max-height: 95vh; overflow-y: auto;">
      <div class="sticky top-0 bg-gradient-to-r from-primary to-indigo-600 text-white px-8 py-6 rounded-t-2xl z-10">
        <div class="flex items-center justify-between">
          <h2 class="text-2xl font-bold">Checking System Homepage - Complete Interface</h2>
          <button onclick="closeHomepageLayoutModal()" class="text-white hover:bg-white/20 rounded-full p-2 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <p class="text-sm opacity-90 mt-2">1:1 replica of the real checking system homepage showing filter-based navigation</p>
      </div>
      <div class="p-8 bg-gray-50">
        <!-- 1:1 Replica of Checking System Homepage -->
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <!-- Header -->
          <div class="mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#4A90E2" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
                <path d="M9 11l2 2 4-4"></path>
              </svg>
              Checking System
            </h1>
            <p class="text-gray-600 text-lg">Search and analyse submitted data from every angle</p>
          </div>
          
          <!-- System Status & Cache Management -->
          <div class="bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200">
            <div class="text-sm font-semibold text-gray-600 mb-3">System Status & Cache Management</div>
            <div class="flex gap-3 flex-wrap items-center">
              <div class="flex items-center gap-2 bg-red-100 text-red-700 px-4 py-2 rounded-full text-sm font-semibold border-2 border-red-300 cursor-pointer hover:bg-red-200">
                <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                <span>üî¥ System Not Ready</span>
              </div>
              <span class="text-sm text-gray-500 flex items-center">Last Synced: <span class="font-mono ml-2">‚Äî</span></span>
            </div>
          </div>
          
          <!-- Filter Chips Display -->
          <div class="bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200">
            <div class="flex items-center justify-between flex-wrap gap-2">
              <div class="flex flex-wrap items-center gap-2">
                <span class="text-sm text-gray-500">No filters applied</span>
              </div>
              <span class="text-sm text-gray-500 font-medium">0 filters applied</span>
            </div>
          </div>
          
          <!-- Configure Filters -->
          <div class="bg-white rounded-lg p-6 mb-6 border-2 border-gray-300 shadow-sm">
            <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#4A90E2" stroke-width="2">
                <line x1="4" y1="21" x2="4" y2="14"></line>
                <line x1="4" y1="10" x2="4" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12" y2="3"></line>
                <line x1="20" y1="21" x2="20" y2="16"></line>
                <line x1="20" y1="12" x2="20" y2="3"></line>
                <line x1="1" y1="14" x2="7" y2="14"></line>
                <line x1="9" y1="8" x2="15" y2="8"></line>
                <line x1="17" y1="16" x2="23" y2="16"></line>
              </svg>
              Configure Filters
            </h2>
            
            <div class="space-y-4">
              <!-- Filter Rules Info Box -->
              <div class="bg-blue-50 rounded p-4 border border-blue-200 flex items-start gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4A90E2" stroke-width="2" class="flex-shrink-0 mt-0.5">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <p class="text-sm text-gray-700">
                  <strong>Filter Rules:</strong> District and Group are independent (can use both). Once you select School ‚Üí Class ‚Üí Student, higher levels become unavailable to prevent conflicts.
                </p>
              </div>
              
              <!-- Add Filter Button -->
              <div class="pt-2">
                <button class="flex items-center gap-2 text-sm font-medium text-primary hover:text-primary/80 transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                  Add filter
                </button>
              </div>
            </div>
            
            <!-- Action Footer -->
            <div class="mt-6 pt-6 border-t border-gray-300 flex items-center justify-end gap-4">
              <button class="bg-gray-200 text-gray-700 px-6 py-2 rounded-full text-sm font-semibold hover:bg-gray-300 transition">
                Clear All
              </button>
              <button class="bg-gray-300 text-gray-500 px-8 py-2.5 rounded-full text-sm font-semibold cursor-not-allowed" disabled>
                Start Checking
              </button>
            </div>
          </div>
          
          <!-- Recent Checks -->
          <div class="bg-gray-50 rounded-lg p-6 border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider mb-4 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              Recent Checks
            </h3>
            <p class="text-sm text-gray-500">No recent checks</p>
          </div>
        </div>
        
        <!-- Explanation Box -->
        <div class="mt-6 p-6 bg-blue-50 border-l-4 border-blue-500 rounded">
          <h4 class="font-semibold text-blue-900 mb-3">üí° How the Filter-Based System Works</h4>
          <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
            <li><strong>Click "Add filter"</strong> to open filter selection dropdowns</li>
            <li><strong>Choose filter type:</strong> District, Group, School, Class, Student, or Grade</li>
            <li><strong>Select filter value:</strong> Choose specific value from dropdown (e.g., "Shatin", "Group 1", etc.)</li>
            <li><strong>Add more filters</strong> as needed (you can combine multiple filters)</li>
            <li><strong>Click "Start Checking"</strong> to navigate to the appropriate drill-down level</li>
          </ol>
          <p class="mt-4 text-sm text-gray-600">
            <strong>Example:</strong> Select "District: Shatin" + "Grade: K1" ‚Üí Click "Start Checking" ‚Üí System navigates to District view showing only Shatin K1 students.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="assets/js/user-guides.js"></script>
</body>
</html>
